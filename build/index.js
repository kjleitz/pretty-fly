!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const n=document.createElement("canvas"),r=()=>{n.width=window.innerWidth,n.height=window.innerHeight};r(),window.addEventListener("resize",r),document.body.appendChild(n);const s=n.getContext("2d");s||console.error("Canvas '2d' context is not supported.");const h=(t,e)=>{requestAnimationFrame(()=>h(t,e)),t.clearRect(0,0,window.innerWidth,window.innerHeight),e()};var o=h;const a=0,c=1,l=.25,d=100,u=(t,e)=>{const[i,n]=t<e?[t,e]:[e,t],r=n-i;return i+Math.random()*r},g=(t,e)=>{e||(e=t,t=0);const[i,n]=t<e?[t,e]:[e,t],r=[...Array(n-i).keys()].map(t=>t+i);return e>=t?r:[n,...r.slice(1).reverse()]},w=(t,e,i=0)=>{if(t===i)return i;if(t>i){const n=t-e;return n<i?i:n}const n=t+e;return n>i?i:n},f=(t,e,i)=>{const[n,r]=e<i?[e,i]:[i,e];return t<n?n:t>r?r:t},y=(t,e,i,n=!0)=>{const[r,s]=e<i?[e,i]:[i,e];return n?t>=r&&t<=s:t>r&&t<s},p=(t,e,i,n,r)=>{let s=t+e,h=e+i;return s>r?(s=r,h=0):s<n&&(s=n,h=0),{position:s,velocity:h}};class b{constructor(t){this.mass=1,this.x=0,this.y=0,this.dx=0,this.dy=0,this.width=25,this.height=25,Object.assign(this,t)}get dragCoefficient(){return(2*this.width+2*this.height)/this.mass/d}get ax(){return a}get ay(){return c}get isAgainstTopWall(){return 0===this.y}get isAgainstBottomWall(){return this.y===window.innerHeight-this.height}get isAgainstLeftWall(){return 0===this.x}get isAgainstRightWall(){return this.x===window.innerWidth-this.width}get terminalVelocity(){return 20}update(){const t=p(this.x,this.dx,this.ax,this.width,window.innerWidth-this.width),e=this.isAgainstTopWall||this.isAgainstBottomWall?l:0;this.x=t.position,this.dx=f(w(t.velocity,e),-1*this.terminalVelocity,this.terminalVelocity);const i=p(this.y,this.dy,this.ay,this.height,window.innerHeight-this.height),n=this.isAgainstLeftWall||this.isAgainstRightWall?l:0;this.y=i.position,this.dy=f(w(i.velocity,n),-1*this.terminalVelocity,this.terminalVelocity)}isHitting(t){const e=t.x,i=t.x+t.width,n=t.y,r=t.y+t.height,s=this.x,h=this.x+this.width,o=this.y,a=this.y+this.height;return h>=e&&s<=i&&a>=n&&o<=r}}var x=new class{constructor(){this.latest=new MouseEvent("mousemove"),window.addEventListener("mousemove",t=>{this.latest=t}),window.addEventListener("mousedown",t=>{this.latest=t}),window.addEventListener("mouseup",t=>{this.latest=t})}};const m=new class extends b{constructor(){super(...arguments),this.width=15,this.height=20,this.jetpackForceX=.4,this.jetpackForceY=1.3}get burning(){return 1===x.latest.buttons}get jetpackAccelerationX(){if(!this.burning)return 0;const t=x.latest.x-this.x,e=-1*this.width,i=2*this.width;if(y(t,e,i))return 0;const n=this.jetpackForceX/this.mass;return t>0?n:-1*n}get jetpackAccelerationY(){if(!this.burning)return 0;const t=x.latest.y-this.y,e=this.height;return t>=0||y(t,0,e)?0:-1*(this.jetpackForceY/this.mass)}get ax(){return super.ax+this.jetpackAccelerationX}get ay(){return super.ay+this.jetpackAccelerationY}get burnerXSide(){return 0===this.jetpackAccelerationX?"none":this.jetpackAccelerationX>0?"left":"right"}get burnerYSide(){return 0===this.jetpackAccelerationY?"none":this.jetpackAccelerationY>0?"top":"bottom"}},v=g(10).map(()=>new b({mass:u(.5,5),x:u(0,window.innerWidth),y:u(0,window.innerHeight),width:u(50,150),height:u(50,150)})),j=g(100).map(()=>{const t=u(1,5);return[u(0,window.innerWidth),u(0,window.innerHeight),t,t]});o(s,()=>{j.forEach((t,e)=>{const i=(e%10+1)/10;s.fillStyle=`rgba(255, 255, 255, ${i})`,s.fillRect(...t)}),v.forEach(t=>{m.isHitting(t)?s.fillStyle="rgba(255, 0, 0, 0.2)":s.fillStyle="rgba(255, 0, 0, 0.5)",s.fillRect(t.x,t.y,t.width,t.height)}),s.fillStyle="rgba(0, 150, 0, 1)",s.fillRect(m.x,m.y,m.width,m.height);const t=m.width/2,e=m.height/5;switch(s.fillStyle="rgba(220, 220, 255, 1)",m.burnerXSide){case"left":s.fillRect(m.x+(m.width-t),m.y+3,t,e);break;case"right":s.fillRect(m.x,m.y+3,t,e);break;default:s.fillRect(m.x+(m.width-t)/2,m.y+3,t,e)}const i=`rgba(255, 100, 0, ${u(.5,.75)})`,n=u(.25,.4)*m.width,r=u(.4,.6)*m.height,h=t=>.6*t,o=t=>(t-h(t))/2;switch(s.fillStyle=i,m.burnerXSide){case"left":s.fillRect(m.x-n,m.y+o(m.height),n,h(m.height));break;case"right":s.fillRect(m.x+m.width,m.y+o(m.height),n,h(m.height))}switch(m.burnerYSide){case"bottom":s.fillRect(m.x+o(m.width),m.y+m.height,h(m.width),r);break;case"top":s.fillRect(m.x+o(m.width),m.y-r,h(m.width),r)}m.update()})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZUxvb3AudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3VuaXZlcnNlLnRzIiwid2VicGFjazovLy8uL3NyYy91dGlsaXRpZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hc3MudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vdXNlLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUGxheWVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3RyZXRjaENhbnZhcyIsIndpZHRoIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImhlaWdodCIsImlubmVySGVpZ2h0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImN0eCIsImdldENvbnRleHQiLCJjb25zb2xlIiwiZXJyb3IiLCJnYW1lTG9vcCIsImRyYXciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjbGVhclJlY3QiLCJHUkFWSVRZX1giLCJHUkFWSVRZX1kiLCJGUklDVElPTiIsIk5PUk1BTF9EUkFHIiwicmFuZCIsIm1pbiIsIm1heCIsInJlYWxNaW4iLCJyZWFsTWF4IiwiZGlmZiIsIk1hdGgiLCJyYW5kb20iLCJyYW5nZSIsImJhc2VBcnJheSIsIkFycmF5Iiwia2V5cyIsIm1hcCIsInNsaWNlIiwicmV2ZXJzZSIsImRhbXBlbiIsIm51bSIsImJ5IiwiY2VudGVyIiwibmV3TnVtIiwiYm91bmQiLCJiZXR3ZWVuIiwiaW5jbHVzaXZlIiwidXBkYXRlRGltZW5zaW9uIiwicG9zaXRpb24iLCJ2ZWxvY2l0eSIsImFjY2VsZXJhdGlvbiIsIm5ld1Bvc2l0aW9uIiwibmV3VmVsb2NpdHkiLCJvcHRpb25zIiwibWFzcyIsIngiLCJ5IiwiZHgiLCJkeSIsImFzc2lnbiIsInRoaXMiLCJuZXdYRGltZW5zaW9uIiwiYXgiLCJ4RnJpY3Rpb24iLCJpc0FnYWluc3RUb3BXYWxsIiwiaXNBZ2FpbnN0Qm90dG9tV2FsbCIsInRlcm1pbmFsVmVsb2NpdHkiLCJuZXdZRGltZW5zaW9uIiwiYXkiLCJ5RnJpY3Rpb24iLCJpc0FnYWluc3RMZWZ0V2FsbCIsImlzQWdhaW5zdFJpZ2h0V2FsbCIsIm1hc3NMZWZ0IiwibWFzc1JpZ2h0IiwibWFzc1RvcCIsIm1hc3NCb3R0b20iLCJ0aGlzTGVmdCIsInRoaXNSaWdodCIsInRoaXNUb3AiLCJ0aGlzQm90dG9tIiwibGF0ZXN0IiwiTW91c2VFdmVudCIsImV2ZW50IiwicGxheWVyIiwiamV0cGFja0ZvcmNlWCIsImpldHBhY2tGb3JjZVkiLCJidXR0b25zIiwiYnVybmluZyIsIm1vdXNlRGlzdGFuY2UiLCJsZWZ0TWFyZ2luIiwicmlnaHRNYXJnaW4iLCJqZXRwYWNrQWNjZWxlcmF0aW9uIiwiYm90dG9tTWFyZ2luIiwic3VwZXIiLCJqZXRwYWNrQWNjZWxlcmF0aW9uWCIsImpldHBhY2tBY2NlbGVyYXRpb25ZIiwibWFzc2VzIiwic3RhcnMiLCJzaXplIiwiZm9yRWFjaCIsInJlY3RPcHRpb25zIiwiaW5kZXgiLCJvcGFjaXR5IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJpc0hpdHRpbmciLCJmYWNlbWFza1dpZHRoIiwiZmFjZW1hc2tIZWlnaHQiLCJidXJuZXJYU2lkZSIsImJ1cm5lckNvbG9yIiwiYnVybmVyTGVuZ3RoWCIsImJ1cm5lckxlbmd0aFkiLCJidXJuZXJBY3Jvc3MiLCJidXJuZXJBY3Jvc3NPZmZzZXQiLCJidXJuZXJZU2lkZSIsInVwZGF0ZSJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUXJCLEVBQW9CcUIsSUFDL0IsRUFBUEUsRUFBVSxPQUFPRixFQUNwQixHQUFXLEVBQVBFLEdBQThCLGlCQUFWRixHQUFzQkEsR0FBU0EsRUFBTUcsV0FBWSxPQUFPSCxFQUNoRixJQUFJSSxFQUFLWCxPQUFPWSxPQUFPLE1B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RyxJQUEyQkEsRUFBUTRHLEVBQWE1RyxJQUFVLEVBR3RGLE9BREFRLEVBQUkyRixVQUFZTSxFQUNSMUIsRUFBT3lCLGFBQ2IsSUFBSyxPQUFRaEcsRUFBSTRGLFNBQ2ZyQixFQUFPNUIsRUFBSXVELEVBQ1gzQixFQUFPM0IsRUFBSXlELEVBQW1COUIsRUFBTzVFLFFBQ3JDdUcsRUFDQUUsRUFBYTdCLEVBQU81RSxTQUNuQixNQUNILElBQUssUUFBU0ssRUFBSTRGLFNBQ2hCckIsRUFBTzVCLEVBQUk0QixFQUFPL0UsTUFDbEIrRSxFQUFPM0IsRUFBSXlELEVBQW1COUIsRUFBTzVFLFFBQ3JDdUcsRUFDQUUsRUFBYTdCLEVBQU81RSxTQUl4QixPQUFRNEUsRUFBTytCLGFBQ2IsSUFBSyxTQUFVdEcsRUFBSTRGLFNBQ2pCckIsRUFBTzVCLEVBQUkwRCxFQUFtQjlCLEVBQU8vRSxPQUNyQytFLEVBQU8zQixFQUFJMkIsRUFBTzVFLE9BQ2xCeUcsRUFBYTdCLEVBQU8vRSxPQUNwQjJHLEdBQ0MsTUFDSCxJQUFLLE1BQU9uRyxFQUFJNEYsU0FDZHJCLEVBQU81QixFQUFJMEQsRUFBbUI5QixFQUFPL0UsT0FDckMrRSxFQUFPM0IsRUFBSXVELEVBQ1hDLEVBQWE3QixFQUFPL0UsT0FDcEIyRyxHQUtKNUIsRUFBT2dDIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cbmNvbnN0IHN0cmV0Y2hDYW52YXMgPSAoKTogdm9pZCA9PiB7XG4gIGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICBjYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xufTtcblxuc3RyZXRjaENhbnZhcygpO1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHN0cmV0Y2hDYW52YXMpO1xuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuXG5jb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSE7XG5pZiAoIWN0eCkgY29uc29sZS5lcnJvcihcIkNhbnZhcyAnMmQnIGNvbnRleHQgaXMgbm90IHN1cHBvcnRlZC5cIik7XG5cbmV4cG9ydCB7IGN0eCB9O1xuZXhwb3J0IGRlZmF1bHQgY2FudmFzO1xuIiwiY29uc3QgZ2FtZUxvb3AgPSAoYzogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBkcmF3OiAoKSA9PiB2b2lkKTogdm9pZCA9PiB7XG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBnYW1lTG9vcChjLCBkcmF3KSk7XG4gIGMuY2xlYXJSZWN0KDAsIDAsIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICBkcmF3KCk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBnYW1lTG9vcDtcbiIsImV4cG9ydCBjb25zdCBHUkFWSVRZX1ggPSAwOyAvLyBweC9mcl4yXG5leHBvcnQgY29uc3QgR1JBVklUWV9ZID0gMTsgLy8gcHgvZnJeMlxuZXhwb3J0IGNvbnN0IEFJUl9SRVNJU1RBTkNFID0gMC4yNTsgLy8gVE9ET1xuZXhwb3J0IGNvbnN0IEZSSUNUSU9OID0gMC4yNTsgLy8gVE9ETzogdGhpcyBzaG91bGQgYmUgZGVwZW5kZW50IG9uIG1hc3NcbmV4cG9ydCBjb25zdCBOT1JNQUxfRFJBRyA9IDEwMDsgLy8gc3VyZmFjZSBhcmVhIGluIHBpeGVscywgcGVyIGtpbG9ncmFtXG4iLCJleHBvcnQgY29uc3QgcmFuZCA9IChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICBjb25zdCBbcmVhbE1pbiwgcmVhbE1heF0gPSBtaW4gPCBtYXggPyBbbWluLCBtYXhdIDogW21heCwgbWluXTtcbiAgY29uc3QgZGlmZiA9IHJlYWxNYXggLSByZWFsTWluO1xuICByZXR1cm4gcmVhbE1pbiArIChNYXRoLnJhbmRvbSgpICogZGlmZik7XG59O1xuXG5leHBvcnQgY29uc3QgcmFuZ2UgPSAobWluOiBudW1iZXIsIG1heD86IG51bWJlcik6IG51bWJlcltdID0+IHtcbiAgaWYgKCFtYXgpIHtcbiAgICBtYXggPSBtaW47IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICBtaW4gPSAwOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gIH1cbiAgY29uc3QgW3JlYWxNaW4sIHJlYWxNYXhdID0gbWluIDwgbWF4ID8gW21pbiwgbWF4XSA6IFttYXgsIG1pbl07XG4gIGNvbnN0IGRpZmYgPSByZWFsTWF4IC0gcmVhbE1pbjtcbiAgY29uc3QgYmFzZUFycmF5ID0gWy4uLkFycmF5KGRpZmYpLmtleXMoKV0ubWFwKG4gPT4gbiArIHJlYWxNaW4pO1xuICByZXR1cm4gbWF4ID49IG1pbiA/IGJhc2VBcnJheSA6IFtyZWFsTWF4LCAuLi5iYXNlQXJyYXkuc2xpY2UoMSkucmV2ZXJzZSgpXTtcbn07XG5cbmV4cG9ydCBjb25zdCBkYW1wZW4gPSAobnVtOiBudW1iZXIsIGJ5OiBudW1iZXIsIGNlbnRlciA9IDApOiBudW1iZXIgPT4ge1xuICAvLyBudW1iZXIgaXMgYWxyZWFkeSBhdCB0aGUgY2VudGVyXG4gIGlmIChudW0gPT09IGNlbnRlcikgcmV0dXJuIGNlbnRlcjtcblxuICAvLyBudW1iZXIgaXMgaGlnaGVyIHRoYW4gdGhlIGNlbnRlcjsgc3VidHJhY3QgYW5kIGRvbid0IG92ZXJzaG9vdCB0aGUgY2VudGVyXG4gIGlmIChudW0gPiBjZW50ZXIpIHtcbiAgICBjb25zdCBuZXdOdW0gPSBudW0gLSBieTtcbiAgICByZXR1cm4gbmV3TnVtIDwgY2VudGVyID8gY2VudGVyIDogbmV3TnVtO1xuICB9XG5cbiAgLy8gbnVtYmVyIGlzIGxvd2VyIHRoYW4gdGhlIGNlbnRlcjsgYWRkIGFuZCBkb24ndCBvdmVyc2hvb3QgdGhlIGNlbnRlclxuICBjb25zdCBuZXdOdW0gPSBudW0gKyBieTtcbiAgcmV0dXJuIG5ld051bSA+IGNlbnRlciA/IGNlbnRlciA6IG5ld051bTtcbn07XG5cbmV4cG9ydCBjb25zdCBib3VuZCA9IChudW06IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgY29uc3QgW3JlYWxNaW4sIHJlYWxNYXhdID0gbWluIDwgbWF4ID8gW21pbiwgbWF4XSA6IFttYXgsIG1pbl07XG4gIGlmIChudW0gPCByZWFsTWluKSByZXR1cm4gcmVhbE1pbjtcbiAgaWYgKG51bSA+IHJlYWxNYXgpIHJldHVybiByZWFsTWF4O1xuICByZXR1cm4gbnVtO1xufTtcblxuZXhwb3J0IGNvbnN0IGJldHdlZW4gPSAobnVtOiBudW1iZXIsIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciwgaW5jbHVzaXZlID0gdHJ1ZSk6IGJvb2xlYW4gPT4ge1xuICBjb25zdCBbcmVhbE1pbiwgcmVhbE1heF0gPSBtaW4gPCBtYXggPyBbbWluLCBtYXhdIDogW21heCwgbWluXTtcbiAgcmV0dXJuIGluY2x1c2l2ZSA/IChudW0gPj0gcmVhbE1pbiAmJiBudW0gPD0gcmVhbE1heCkgOiAobnVtID4gcmVhbE1pbiAmJiBudW0gPCByZWFsTWF4KTtcbn07XG4iLCJpbXBvcnQgeyBHUkFWSVRZX1gsIEdSQVZJVFlfWSwgRlJJQ1RJT04sIE5PUk1BTF9EUkFHIH0gZnJvbSBcIi4vdW5pdmVyc2VcIjtcbmltcG9ydCB7IGRhbXBlbiwgYm91bmQgfSBmcm9tIFwiLi91dGlsaXRpZXNcIjtcblxuY29uc3QgdXBkYXRlRGltZW5zaW9uID0gKFxuICBwb3NpdGlvbjogbnVtYmVyLFxuICB2ZWxvY2l0eTogbnVtYmVyLFxuICBhY2NlbGVyYXRpb246IG51bWJlcixcbiAgbWluOiBudW1iZXIsXG4gIG1heDogbnVtYmVyLFxuKTogeyBwb3NpdGlvbjogbnVtYmVyOyB2ZWxvY2l0eTogbnVtYmVyIH0gPT4ge1xuICBsZXQgbmV3UG9zaXRpb24gPSBwb3NpdGlvbiArIHZlbG9jaXR5O1xuICBsZXQgbmV3VmVsb2NpdHkgPSB2ZWxvY2l0eSArIGFjY2VsZXJhdGlvbjtcbiAgaWYgKG5ld1Bvc2l0aW9uID4gbWF4KSB7XG4gICAgbmV3UG9zaXRpb24gPSBtYXg7XG4gICAgbmV3VmVsb2NpdHkgPSAwO1xuICB9IGVsc2UgaWYgKG5ld1Bvc2l0aW9uIDwgbWluKSB7XG4gICAgbmV3UG9zaXRpb24gPSBtaW47XG4gICAgbmV3VmVsb2NpdHkgPSAwO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBwb3NpdGlvbjogbmV3UG9zaXRpb24sXG4gICAgdmVsb2NpdHk6IG5ld1ZlbG9jaXR5LFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFzcyB7XG4gIHB1YmxpYyBtYXNzID0gMTsgLy8ga2dcbiAgcHVibGljIHggPSAwOyAvLyBweFxuICBwdWJsaWMgeSA9IDA7IC8vIHB4XG4gIHB1YmxpYyBkeCA9IDA7IC8vIHB4L2ZyXG4gIHB1YmxpYyBkeSA9IDA7IC8vIHB4L2ZyXG4gIHB1YmxpYyB3aWR0aCA9IDI1O1xuICBwdWJsaWMgaGVpZ2h0ID0gMjU7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IFBhcnRpYWw8TWFzcz4pIHtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpO1xuICB9XG5cbiAgZ2V0IGRyYWdDb2VmZmljaWVudCgpOiBudW1iZXIge1xuICAgIGNvbnN0IHN1cmZhY2VBcmVhID0gKDIgKiB0aGlzLndpZHRoKSArICgyICogdGhpcy5oZWlnaHQpO1xuICAgIHJldHVybiAoc3VyZmFjZUFyZWEgLyB0aGlzLm1hc3MpIC8gTk9STUFMX0RSQUc7XG4gIH1cblxuICBnZXQgYXgoKTogbnVtYmVyIHsgcmV0dXJuIEdSQVZJVFlfWDsgfVxuICBnZXQgYXkoKTogbnVtYmVyIHsgcmV0dXJuIEdSQVZJVFlfWTsgfVxuXG4gIGdldCBpc0FnYWluc3RUb3BXYWxsKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy55ID09PSAwOyB9XG4gIGdldCBpc0FnYWluc3RCb3R0b21XYWxsKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy55ID09PSB3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmhlaWdodDsgfVxuICBnZXQgaXNBZ2FpbnN0TGVmdFdhbGwoKTogYm9vbGVhbiB7IHJldHVybiB0aGlzLnggPT09IDA7IH1cbiAgZ2V0IGlzQWdhaW5zdFJpZ2h0V2FsbCgpOiBib29sZWFuIHsgcmV0dXJuIHRoaXMueCA9PT0gd2luZG93LmlubmVyV2lkdGggLSB0aGlzLndpZHRoOyB9XG5cbiAgZ2V0IHRlcm1pbmFsVmVsb2NpdHkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gMjA7IC8vIFRPRE86IHNob3VsZCBiZSBiYXNlZCBvbiBkcmFnXG4gIH1cblxuICB1cGRhdGUoKTogdm9pZCB7XG4gICAgY29uc3QgbmV3WERpbWVuc2lvbiA9IHVwZGF0ZURpbWVuc2lvbih0aGlzLngsIHRoaXMuZHgsIHRoaXMuYXgsIHRoaXMud2lkdGgsIHdpbmRvdy5pbm5lcldpZHRoIC0gdGhpcy53aWR0aCk7XG4gICAgY29uc3QgeEZyaWN0aW9uID0gdGhpcy5pc0FnYWluc3RUb3BXYWxsIHx8IHRoaXMuaXNBZ2FpbnN0Qm90dG9tV2FsbCA/IEZSSUNUSU9OIDogMDtcbiAgICB0aGlzLnggPSBuZXdYRGltZW5zaW9uLnBvc2l0aW9uO1xuICAgIHRoaXMuZHggPSBib3VuZChkYW1wZW4obmV3WERpbWVuc2lvbi52ZWxvY2l0eSwgeEZyaWN0aW9uKSwgLTEgKiB0aGlzLnRlcm1pbmFsVmVsb2NpdHksIHRoaXMudGVybWluYWxWZWxvY2l0eSk7XG5cbiAgICBjb25zdCBuZXdZRGltZW5zaW9uID0gdXBkYXRlRGltZW5zaW9uKHRoaXMueSwgdGhpcy5keSwgdGhpcy5heSwgdGhpcy5oZWlnaHQsIHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuaGVpZ2h0KTtcbiAgICBjb25zdCB5RnJpY3Rpb24gPSB0aGlzLmlzQWdhaW5zdExlZnRXYWxsIHx8IHRoaXMuaXNBZ2FpbnN0UmlnaHRXYWxsID8gRlJJQ1RJT04gOiAwO1xuICAgIHRoaXMueSA9IG5ld1lEaW1lbnNpb24ucG9zaXRpb247XG4gICAgdGhpcy5keSA9IGJvdW5kKGRhbXBlbihuZXdZRGltZW5zaW9uLnZlbG9jaXR5LCB5RnJpY3Rpb24pLCAtMSAqIHRoaXMudGVybWluYWxWZWxvY2l0eSwgdGhpcy50ZXJtaW5hbFZlbG9jaXR5KTtcbiAgfVxuXG4gIGlzSGl0dGluZyhtYXNzOiBNYXNzKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbWFzc0xlZnQgPSBtYXNzLng7XG4gICAgY29uc3QgbWFzc1JpZ2h0ID0gbWFzcy54ICsgbWFzcy53aWR0aDtcbiAgICBjb25zdCBtYXNzVG9wID0gbWFzcy55O1xuICAgIGNvbnN0IG1hc3NCb3R0b20gPSBtYXNzLnkgKyBtYXNzLmhlaWdodDtcblxuICAgIGNvbnN0IHRoaXNMZWZ0ID0gdGhpcy54O1xuICAgIGNvbnN0IHRoaXNSaWdodCA9IHRoaXMueCArIHRoaXMud2lkdGg7XG4gICAgY29uc3QgdGhpc1RvcCA9IHRoaXMueTtcbiAgICBjb25zdCB0aGlzQm90dG9tID0gdGhpcy55ICsgdGhpcy5oZWlnaHQ7XG5cbiAgICByZXR1cm4gKFxuICAgICAgdGhpc1JpZ2h0ID49IG1hc3NMZWZ0XG4gICAgICAmJiB0aGlzTGVmdCA8PSBtYXNzUmlnaHRcbiAgICAgICYmIHRoaXNCb3R0b20gPj0gbWFzc1RvcFxuICAgICAgJiYgdGhpc1RvcCA8PSBtYXNzQm90dG9tXG4gICAgKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIE1vdXNlIHtcbiAgcHVibGljIGxhdGVzdDogTW91c2VFdmVudDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmxhdGVzdCA9IG5ldyBNb3VzZUV2ZW50KCdtb3VzZW1vdmUnKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmxhdGVzdCA9IGV2ZW50O1xuICAgIH0pO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMubGF0ZXN0ID0gZXZlbnQ7XG4gICAgfSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMubGF0ZXN0ID0gZXZlbnQ7XG4gICAgfSk7XG4gIH1cbn1cblxuY29uc3QgbW91c2UgPSBuZXcgTW91c2UoKTtcblxuZXhwb3J0IGRlZmF1bHQgbW91c2U7XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuXG5pbXBvcnQgeyBjdHggfSBmcm9tICcuL2NhbnZhcyc7XG5pbXBvcnQgZ2FtZUxvb3AgZnJvbSAnLi9nYW1lTG9vcCc7XG5pbXBvcnQgTWFzcyBmcm9tICcuL01hc3MnO1xuaW1wb3J0IFBsYXllciBmcm9tICcuL1BsYXllcic7XG5pbXBvcnQgeyByYW5nZSwgcmFuZCB9IGZyb20gJy4vdXRpbGl0aWVzJztcblxuY29uc3QgcGxheWVyID0gbmV3IFBsYXllcigpO1xuXG5jb25zdCBtYXNzZXMgPSByYW5nZSgxMCkubWFwKCgpID0+IHtcbiAgcmV0dXJuIG5ldyBNYXNzKHtcbiAgICBtYXNzOiByYW5kKDAuNSwgNSksXG4gICAgeDogcmFuZCgwLCB3aW5kb3cuaW5uZXJXaWR0aCksXG4gICAgeTogcmFuZCgwLCB3aW5kb3cuaW5uZXJIZWlnaHQpLFxuICAgIHdpZHRoOiByYW5kKDUwLCAxNTApLFxuICAgIGhlaWdodDogcmFuZCg1MCwgMTUwKSxcbiAgfSk7XG59KTtcblxuY29uc3Qgc3RhcnMgPSByYW5nZSgxMDApLm1hcCgoKSA9PiB7XG4gIGNvbnN0IHNpemUgPSByYW5kKDEsIDUpO1xuICByZXR1cm4gW1xuICAgIHJhbmQoMCwgd2luZG93LmlubmVyV2lkdGgpLFxuICAgIHJhbmQoMCwgd2luZG93LmlubmVySGVpZ2h0KSxcbiAgICBzaXplLFxuICAgIHNpemUsXG4gIF0gYXMgY29uc3Q7XG59KTtcblxuZ2FtZUxvb3AoY3R4LCAoKSA9PiB7XG4gIHN0YXJzLmZvckVhY2goKHJlY3RPcHRpb25zLCBpbmRleCkgPT4ge1xuICAgIGNvbnN0IG9wYWNpdHkgPSAoKGluZGV4ICUgMTApICsgMSkgLyAxMDtcbiAgICBjdHguZmlsbFN0eWxlID0gYHJnYmEoMjU1LCAyNTUsIDI1NSwgJHtvcGFjaXR5fSlgO1xuICAgIGN0eC5maWxsUmVjdCguLi5yZWN0T3B0aW9ucyk7XG4gIH0pO1xuXG4gIG1hc3Nlcy5mb3JFYWNoKChtYXNzKSA9PiB7XG4gICAgaWYgKHBsYXllci5pc0hpdHRpbmcobWFzcykpIHtcbiAgICAgIGN0eC5maWxsU3R5bGUgPSAncmdiYSgyNTUsIDAsIDAsIDAuMiknO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdHguZmlsbFN0eWxlID0gJ3JnYmEoMjU1LCAwLCAwLCAwLjUpJztcbiAgICB9XG5cbiAgICBjdHguZmlsbFJlY3QobWFzcy54LCBtYXNzLnksIG1hc3Mud2lkdGgsIG1hc3MuaGVpZ2h0KTtcbiAgfSk7XG5cbiAgY3R4LmZpbGxTdHlsZSA9ICdyZ2JhKDAsIDE1MCwgMCwgMSknO1xuICBjdHguZmlsbFJlY3QocGxheWVyLngsIHBsYXllci55LCBwbGF5ZXIud2lkdGgsIHBsYXllci5oZWlnaHQpO1xuXG4gIGNvbnN0IGZhY2VtYXNrQ29sb3IgPSAncmdiYSgyMjAsIDIyMCwgMjU1LCAxKSc7XG4gIGNvbnN0IGZhY2VtYXNrV2lkdGggPSBwbGF5ZXIud2lkdGggLyAyO1xuICBjb25zdCBmYWNlbWFza0hlaWdodCA9IHBsYXllci5oZWlnaHQgLyA1O1xuICBjb25zdCBmYWNlbWFza09mZnNldFkgPSAzO1xuICBjdHguZmlsbFN0eWxlID0gZmFjZW1hc2tDb2xvcjtcbiAgc3dpdGNoIChwbGF5ZXIuYnVybmVyWFNpZGUpIHtcbiAgICBjYXNlICdsZWZ0JzogY3R4LmZpbGxSZWN0KHBsYXllci54ICsgKHBsYXllci53aWR0aCAtIGZhY2VtYXNrV2lkdGgpLCBwbGF5ZXIueSArIGZhY2VtYXNrT2Zmc2V0WSwgZmFjZW1hc2tXaWR0aCwgZmFjZW1hc2tIZWlnaHQpOyBicmVhaztcbiAgICBjYXNlICdyaWdodCc6IGN0eC5maWxsUmVjdChwbGF5ZXIueCwgcGxheWVyLnkgKyBmYWNlbWFza09mZnNldFksIGZhY2VtYXNrV2lkdGgsIGZhY2VtYXNrSGVpZ2h0KTsgYnJlYWs7XG4gICAgZGVmYXVsdDogY3R4LmZpbGxSZWN0KHBsYXllci54ICsgKChwbGF5ZXIud2lkdGggLSBmYWNlbWFza1dpZHRoKSAvIDIpLCBwbGF5ZXIueSArIGZhY2VtYXNrT2Zmc2V0WSwgZmFjZW1hc2tXaWR0aCwgZmFjZW1hc2tIZWlnaHQpOyBicmVhaztcbiAgfVxuXG4gIGNvbnN0IGJ1cm5lckNvbG9yID0gYHJnYmEoMjU1LCAxMDAsIDAsICR7cmFuZCgwLjUsIDAuNzUpfSlgO1xuICBjb25zdCBidXJuZXJMZW5ndGhYID0gcmFuZCgwLjI1LCAwLjQpICogcGxheWVyLndpZHRoO1xuICBjb25zdCBidXJuZXJMZW5ndGhZID0gcmFuZCgwLjQsIDAuNikgKiBwbGF5ZXIuaGVpZ2h0O1xuICBjb25zdCBidXJuZXJBY3Jvc3MgPSAod2lkdGg6IG51bWJlcik6IG51bWJlciA9PiAwLjYgKiB3aWR0aDtcbiAgY29uc3QgYnVybmVyQWNyb3NzT2Zmc2V0ID0gKHdpZHRoOiBudW1iZXIpOiBudW1iZXIgPT4gKHdpZHRoIC0gYnVybmVyQWNyb3NzKHdpZHRoKSkgLyAyO1xuXG4gIGN0eC5maWxsU3R5bGUgPSBidXJuZXJDb2xvcjtcbiAgc3dpdGNoIChwbGF5ZXIuYnVybmVyWFNpZGUpIHtcbiAgICBjYXNlICdsZWZ0JzogY3R4LmZpbGxSZWN0KFxuICAgICAgcGxheWVyLnggLSBidXJuZXJMZW5ndGhYLCAvLyBwb3NpdGlvbmVkIG9uIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIHBsYXllclxuICAgICAgcGxheWVyLnkgKyBidXJuZXJBY3Jvc3NPZmZzZXQocGxheWVyLmhlaWdodCksIC8vIGNlbnRlcmVkIG9uIHRoZSBZIGF4aXNcbiAgICAgIGJ1cm5lckxlbmd0aFgsIC8vIGxvbmcgdGFpbCBvcmllbnRlZCBhbG9uZyB0aGUgWCBheGlzXG4gICAgICBidXJuZXJBY3Jvc3MocGxheWVyLmhlaWdodCksIC8vIGNyb3NzLXNlY3Rpb24gb3JpZW50ZWQgYWxvbmcgdGhlIFkgYXhpc1xuICAgICk7IGJyZWFrO1xuICAgIGNhc2UgJ3JpZ2h0JzogY3R4LmZpbGxSZWN0KFxuICAgICAgcGxheWVyLnggKyBwbGF5ZXIud2lkdGgsIC8vIHBvc2l0aW9uZWQgb24gdGhlIHJpZ2h0IHNpZGUgb2YgdGhlIHBsYXllclxuICAgICAgcGxheWVyLnkgKyBidXJuZXJBY3Jvc3NPZmZzZXQocGxheWVyLmhlaWdodCksIC8vIGNlbnRlcmVkIG9uIHRoZSBZIGF4aXNcbiAgICAgIGJ1cm5lckxlbmd0aFgsIC8vIGxvbmcgdGFpbCBvcmllbnRlZCBhbG9uZyB0aGUgWCBheGlzXG4gICAgICBidXJuZXJBY3Jvc3MocGxheWVyLmhlaWdodCksIC8vIGNyb3NzLXNlY3Rpb24gb3JpZW50ZWQgYWxvbmcgdGhlIFkgYXhpc1xuICAgICk7IGJyZWFrO1xuICAgIGRlZmF1bHQ6IGJyZWFrO1xuICB9XG4gIHN3aXRjaCAocGxheWVyLmJ1cm5lcllTaWRlKSB7XG4gICAgY2FzZSAnYm90dG9tJzogY3R4LmZpbGxSZWN0KFxuICAgICAgcGxheWVyLnggKyBidXJuZXJBY3Jvc3NPZmZzZXQocGxheWVyLndpZHRoKSwgLy8gY2VudGVyZWQgb24gdGhlIFggYXhpc1xuICAgICAgcGxheWVyLnkgKyBwbGF5ZXIuaGVpZ2h0LCAvLyBwb3NpdGlvbmVkIG9uIHRoZSBib3R0b20gb2YgdGhlIHBsYXllclxuICAgICAgYnVybmVyQWNyb3NzKHBsYXllci53aWR0aCksIC8vIGNyb3NzLXNlY3Rpb24gb3JpZW50ZWQgYWxvbmcgdGhlIFggYXhpc1xuICAgICAgYnVybmVyTGVuZ3RoWSwgLy8gbG9uZyB0YWlsIG9yaWVudGVkIGFsb25nIHRoZSBZIGF4aXNcbiAgICApOyBicmVhaztcbiAgICBjYXNlICd0b3AnOiBjdHguZmlsbFJlY3QoXG4gICAgICBwbGF5ZXIueCArIGJ1cm5lckFjcm9zc09mZnNldChwbGF5ZXIud2lkdGgpLCAvLyBjZW50ZXJlZCBvbiB0aGUgWCBheGlzXG4gICAgICBwbGF5ZXIueSAtIGJ1cm5lckxlbmd0aFksIC8vIHBvc2l0aW9uZWQgb24gdGhlIHRvcCBvZiB0aGUgcGxheWVyXG4gICAgICBidXJuZXJBY3Jvc3MocGxheWVyLndpZHRoKSwgLy8gY3Jvc3Mtc2VjdGlvbiBvcmllbnRlZCBhbG9uZyB0aGUgWCBheGlzXG4gICAgICBidXJuZXJMZW5ndGhZLCAvLyBsb25nIHRhaWwgb3JpZW50ZWQgYWxvbmcgdGhlIFkgYXhpc1xuICAgICk7IGJyZWFrO1xuICAgIGRlZmF1bHQ6IGJyZWFrO1xuICB9XG5cbiAgcGxheWVyLnVwZGF0ZSgpO1xufSk7XG4iLCJpbXBvcnQgTWFzcyBmcm9tIFwiLi9NYXNzXCI7XG5pbXBvcnQgbW91c2UgZnJvbSBcIi4vbW91c2VcIjtcbmltcG9ydCB7IGJldHdlZW4gfSBmcm9tIFwiLi91dGlsaXRpZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxheWVyIGV4dGVuZHMgTWFzcyB7XG4gIHB1YmxpYyB3aWR0aCA9IDE1O1xuICBwdWJsaWMgaGVpZ2h0ID0gMjA7XG4gIHB1YmxpYyBqZXRwYWNrRm9yY2VYID0gMC40OyAvLyAoa2cgKiBweCkgLyBmcl4yXG4gIHB1YmxpYyBqZXRwYWNrRm9yY2VZID0gMS4zOyAvLyAoa2cgKiBweCkgLyBmcl4yXG5cbiAgZ2V0IGJ1cm5pbmcoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIG1vdXNlLmxhdGVzdC5idXR0b25zID09PSAxO1xuICB9XG5cbiAgZ2V0IGpldHBhY2tBY2NlbGVyYXRpb25YKCk6IG51bWJlciB7XG4gICAgaWYgKCF0aGlzLmJ1cm5pbmcpIHJldHVybiAwO1xuXG4gICAgY29uc3QgbW91c2VEaXN0YW5jZSA9IG1vdXNlLmxhdGVzdC54IC0gdGhpcy54O1xuICAgIGNvbnN0IGxlZnRNYXJnaW4gPSAtMSAqIHRoaXMud2lkdGg7XG4gICAgY29uc3QgcmlnaHRNYXJnaW4gPSAyICogdGhpcy53aWR0aDtcbiAgICBpZiAoYmV0d2Vlbihtb3VzZURpc3RhbmNlLCBsZWZ0TWFyZ2luLCByaWdodE1hcmdpbikpIHJldHVybiAwO1xuXG4gICAgY29uc3QgamV0cGFja0FjY2VsZXJhdGlvbiA9IHRoaXMuamV0cGFja0ZvcmNlWCAvIHRoaXMubWFzcztcbiAgICByZXR1cm4gbW91c2VEaXN0YW5jZSA+IDAgPyBqZXRwYWNrQWNjZWxlcmF0aW9uIDogLTEgKiBqZXRwYWNrQWNjZWxlcmF0aW9uO1xuICB9XG5cbiAgZ2V0IGpldHBhY2tBY2NlbGVyYXRpb25ZKCk6IG51bWJlciB7XG4gICAgaWYgKCF0aGlzLmJ1cm5pbmcpIHJldHVybiAwO1xuXG4gICAgY29uc3QgbW91c2VEaXN0YW5jZSA9IG1vdXNlLmxhdGVzdC55IC0gdGhpcy55O1xuICAgIGNvbnN0IHRvcE1hcmdpbiA9IDA7XG4gICAgY29uc3QgYm90dG9tTWFyZ2luID0gdGhpcy5oZWlnaHQ7XG4gICAgaWYgKG1vdXNlRGlzdGFuY2UgPj0gMCB8fCBiZXR3ZWVuKG1vdXNlRGlzdGFuY2UsIHRvcE1hcmdpbiwgYm90dG9tTWFyZ2luKSkgcmV0dXJuIDA7XG5cbiAgICBjb25zdCBqZXRwYWNrQWNjZWxlcmF0aW9uID0gdGhpcy5qZXRwYWNrRm9yY2VZIC8gdGhpcy5tYXNzO1xuICAgIHJldHVybiAtMSAqIGpldHBhY2tBY2NlbGVyYXRpb247XG4gIH1cblxuICBnZXQgYXgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gc3VwZXIuYXggKyB0aGlzLmpldHBhY2tBY2NlbGVyYXRpb25YO1xuICB9XG5cbiAgZ2V0IGF5KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHN1cGVyLmF5ICsgdGhpcy5qZXRwYWNrQWNjZWxlcmF0aW9uWTtcbiAgfVxuXG4gIGdldCBidXJuZXJYU2lkZSgpOiAnbGVmdCd8J25vbmUnfCdyaWdodCcge1xuICAgIGlmICh0aGlzLmpldHBhY2tBY2NlbGVyYXRpb25YID09PSAwKSByZXR1cm4gJ25vbmUnO1xuICAgIHJldHVybiB0aGlzLmpldHBhY2tBY2NlbGVyYXRpb25YID4gMCA/ICdsZWZ0JyA6ICdyaWdodCc7XG4gIH1cblxuICBnZXQgYnVybmVyWVNpZGUoKTogJ2JvdHRvbSd8J25vbmUnfCd0b3AnIHtcbiAgICBpZiAodGhpcy5qZXRwYWNrQWNjZWxlcmF0aW9uWSA9PT0gMCkgcmV0dXJuICdub25lJztcbiAgICByZXR1cm4gdGhpcy5qZXRwYWNrQWNjZWxlcmF0aW9uWSA+IDAgPyAndG9wJyA6ICdib3R0b20nO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9