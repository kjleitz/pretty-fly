!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const n=document.createElement("canvas"),r=()=>{n.width=window.innerWidth,n.height=window.innerHeight};r(),window.addEventListener("resize",r),document.body.appendChild(n);const s=n.getContext("2d");s||console.error("Canvas '2d' context is not supported.");const h=(t,e)=>{requestAnimationFrame(()=>h(t,e)),t.clearRect(0,0,window.innerWidth,window.innerHeight),e()};var o=h;const c=0,a=1,l=.25,d=100,u=(t,e)=>{const[i,n]=t<e?[t,e]:[e,t],r=n-i;return i+Math.random()*r},g=(t,e)=>{e||(e=t,t=0);const[i,n]=t<e?[t,e]:[e,t],r=[...Array(n-i).keys()].map(t=>t+i);return e>=t?r:[n,...r.slice(1).reverse()]},p=(t,e,i=0)=>{if(t===i)return i;if(t>i){const n=t-e;return n<i?i:n}const n=t+e;return n>i?i:n},w=(t,e,i)=>{const[n,r]=e<i?[e,i]:[i,e];return t<n?n:t>r?r:t},y=(t,e,i,n=!0)=>{const[r,s]=e<i?[e,i]:[i,e];return n?t>=r&&t<=s:t>r&&t<s},f=(t,e,i,n,r)=>{let s=t+e,h=e+i;return s>r?(s=r,h=0):s<n&&(s=n,h=0),{position:s,velocity:h}};class m{constructor(t){this.mass=1,this.x=0,this.y=0,this.dx=0,this.dy=0,this.width=25,this.height=25,Object.assign(this,t)}get dragCoefficient(){return(2*this.width+2*this.height)/this.mass/d}get ax(){return c}get ay(){return a}get isAgainstTopWall(){return 0===this.y}get isAgainstBottomWall(){return this.y===window.innerHeight-this.height}get isAgainstLeftWall(){return 0===this.x}get isAgainstRightWall(){return this.x===window.innerWidth-this.width}get terminalVelocity(){return 20}update(){const t=f(this.x,this.dx,this.ax,this.width,window.innerWidth-this.width),e=this.isAgainstTopWall||this.isAgainstBottomWall?l:0;this.x=t.position,this.dx=w(p(t.velocity,e),-1*this.terminalVelocity,this.terminalVelocity);const i=f(this.y,this.dy,this.ay,this.height,window.innerHeight-this.height),n=this.isAgainstLeftWall||this.isAgainstRightWall?l:0;this.y=i.position,this.dy=w(p(i.velocity,n),-1*this.terminalVelocity,this.terminalVelocity)}isHitting(t){const e=t.x,i=t.x+t.width,n=t.y,r=t.y+t.height,s=this.x,h=this.x+this.width,o=this.y,c=this.y+this.height;return h>=e&&s<=i&&c>=n&&o<=r}}var x=new class{constructor(){this.x=0,this.y=0,this.pressed=!1,window.addEventListener("mousedown",t=>{this.populateFromMouseEvent(t)}),window.addEventListener("mousemove",t=>{this.populateFromMouseEvent(t)}),window.addEventListener("mouseup",t=>{this.populateFromMouseEvent(t)}),window.addEventListener("touchstart",t=>{this.populateFromTouchEvent(t)}),window.addEventListener("touchmove",t=>{this.populateFromTouchEvent(t)}),window.addEventListener("touchend",t=>{this.populateFromTouchEvent(t)})}populateFromMouseEvent(t){this.x=t.x,this.y=t.y,this.pressed=1===t.buttons}populateFromTouchEvent(t){const{touches:e}=t;if(0===e.length)this.pressed=!1;else{const t=e[0];this.x=t.clientX,this.y=t.clientY,this.pressed=!0}}};const b=new class extends m{constructor(){super(...arguments),this.width=15,this.height=20,this.jetpackForceX=.4,this.jetpackForceY=1.3}get burning(){return x.pressed}get jetpackAccelerationX(){if(!this.burning)return 0;const t=x.x-this.x,e=-1*this.width,i=2*this.width;if(y(t,e,i))return 0;const n=this.jetpackForceX/this.mass;return t>0?n:-1*n}get jetpackAccelerationY(){if(!this.burning)return 0;const t=x.y-this.y,e=this.height;return t>=0||y(t,0,e)?0:-1*(this.jetpackForceY/this.mass)}get ax(){return super.ax+this.jetpackAccelerationX}get ay(){return super.ay+this.jetpackAccelerationY}get burnerXSide(){return 0===this.jetpackAccelerationX?"none":this.jetpackAccelerationX>0?"left":"right"}get burnerYSide(){return 0===this.jetpackAccelerationY?"none":this.jetpackAccelerationY>0?"top":"bottom"}},v=g(10).map(()=>new m({mass:u(.5,5),x:u(0,window.innerWidth),y:u(0,window.innerHeight),width:u(50,150),height:u(50,150)})),j=g(100).map(()=>{const t=u(1,5);return[u(0,window.innerWidth),u(0,window.innerHeight),t,t]});o(s,()=>{j.forEach((t,e)=>{const i=(e%10+1)/10;s.fillStyle=`rgba(255, 255, 255, ${i})`,s.fillRect(...t)}),v.forEach(t=>{b.isHitting(t)?s.fillStyle="rgba(255, 0, 0, 0.2)":s.fillStyle="rgba(255, 0, 0, 0.5)",s.fillRect(t.x,t.y,t.width,t.height)}),s.fillStyle="rgba(0, 150, 0, 1)",s.fillRect(b.x,b.y,b.width,b.height);const t=b.width/2,e=b.height/5;switch(s.fillStyle="rgba(220, 220, 255, 1)",b.burnerXSide){case"left":s.fillRect(b.x+(b.width-t),b.y+3,t,e);break;case"right":s.fillRect(b.x,b.y+3,t,e);break;default:s.fillRect(b.x+(b.width-t)/2,b.y+3,t,e)}const i=`rgba(255, 100, 0, ${u(.5,.75)})`,n=u(.25,.4)*b.width,r=u(.4,.6)*b.height,h=t=>.6*t,o=t=>(t-h(t))/2;switch(s.fillStyle=i,b.burnerXSide){case"left":s.fillRect(b.x-n,b.y+o(b.height),n,h(b.height));break;case"right":s.fillRect(b.x+b.width,b.y+o(b.height),n,h(b.height))}switch(b.burnerYSide){case"bottom":s.fillRect(b.x+o(b.width),b.y+b.height,h(b.width),r);break;case"top":s.fillRect(b.x+o(b.width),b.y-r,h(b.width),r)}b.update()})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZUxvb3AudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3VuaXZlcnNlLnRzIiwid2VicGFjazovLy8uL3NyYy91dGlsaXRpZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hc3MudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vdXNlLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUGxheWVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3RyZXRjaENhbnZhcyIsIndpZHRoIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImhlaWdodCIsImlubmVySGVpZ2h0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImN0eCIsImdldENvbnRleHQiLCJjb25zb2xlIiwiZXJyb3IiLCJnYW1lTG9vcCIsImRyYXciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjbGVhclJlY3QiLCJHUkFWSVRZX1giLCJHUkFWSVRZX1kiLCJGUklDVElPTiIsIk5PUk1BTF9EUkFHIiwicmFuZCIsIm1pbiIsIm1heCIsInJlYWxNaW4iLCJyZWFsTWF4IiwiZGlmZiIsIk1hdGgiLCJyYW5kb20iLCJyYW5nZSIsImJhc2VBcnJheSIsIkFycmF5Iiwia2V5cyIsIm1hcCIsInNsaWNlIiwicmV2ZXJzZSIsImRhbXBlbiIsIm51bSIsImJ5IiwiY2VudGVyIiwibmV3TnVtIiwiYm91bmQiLCJiZXR3ZWVuIiwiaW5jbHVzaXZlIiwidXBkYXRlRGltZW5zaW9uIiwicG9zaXRpb24iLCJ2ZWxvY2l0eSIsImFjY2VsZXJhdGlvbiIsIm5ld1Bvc2l0aW9uIiwibmV3VmVsb2NpdHkiLCJvcHRpb25zIiwibWFzcyIsIngiLCJ5IiwiZHgiLCJkeSIsImFzc2lnbiIsInRoaXMiLCJuZXdYRGltZW5zaW9uIiwiYXgiLCJ4RnJpY3Rpb24iLCJpc0FnYWluc3RUb3BXYWxsIiwiaXNBZ2FpbnN0Qm90dG9tV2FsbCIsInRlcm1pbmFsVmVsb2NpdHkiLCJuZXdZRGltZW5zaW9uIiwiYXkiLCJ5RnJpY3Rpb24iLCJpc0FnYWluc3RMZWZ0V2FsbCIsImlzQWdhaW5zdFJpZ2h0V2FsbCIsIm1hc3NMZWZ0IiwibWFzc1JpZ2h0IiwibWFzc1RvcCIsIm1hc3NCb3R0b20iLCJ0aGlzTGVmdCIsInRoaXNSaWdodCIsInRoaXNUb3AiLCJ0aGlzQm90dG9tIiwicHJlc3NlZCIsImV2ZW50IiwicG9wdWxhdGVGcm9tTW91c2VFdmVudCIsInBvcHVsYXRlRnJvbVRvdWNoRXZlbnQiLCJidXR0b25zIiwidG91Y2hlcyIsImxlbmd0aCIsInRvdWNoIiwiY2xpZW50WCIsImNsaWVudFkiLCJwbGF5ZXIiLCJqZXRwYWNrRm9yY2VYIiwiamV0cGFja0ZvcmNlWSIsImJ1cm5pbmciLCJtb3VzZURpc3RhbmNlIiwibGVmdE1hcmdpbiIsInJpZ2h0TWFyZ2luIiwiamV0cGFja0FjY2VsZXJhdGlvbiIsImJvdHRvbU1hcmdpbiIsInN1cGVyIiwiamV0cGFja0FjY2VsZXJhdGlvblgiLCJqZXRwYWNrQWNjZWxlcmF0aW9uWSIsIm1hc3NlcyIsInN0YXJzIiwic2l6ZSIsImZvckVhY2giLCJyZWN0T3B0aW9ucyIsImluZGV4Iiwib3BhY2l0eSIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiaXNIaXR0aW5nIiwiZmFjZW1hc2tXaWR0aCIsImZhY2VtYXNrSGVpZ2h0IiwiYnVybmVyWFNpZGUiLCJidXJuZXJDb2xvciIsImJ1cm5lckxlbmd0aFgiLCJidXJuZXJMZW5ndGhZIiwiYnVybmVyQWNyb3NzIiwiYnVybmVyQWNyb3NzT2Zmc2V0IiwiYnVybmVyWVNpZGUiLCJ1cGRhdGUiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIs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QUNyQ3NGLEVBQU9sQyxFQUFJa0MsRUFBT25GLE9BQ2xCK0csRUFBYTVCLEVBQU90RixPQUNwQmlILEdBQ0MsTUFDSCxJQUFLLE1BQU96RyxFQUFJa0csU0FDZHBCLEVBQU9uQyxFQUFJZ0UsRUFBbUI3QixFQUFPdEYsT0FDckNzRixFQUFPbEMsRUFBSTZELEVBQ1hDLEVBQWE1QixFQUFPdEYsT0FDcEJpSCxHQUtKM0IsRUFBTytCIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cbmNvbnN0IHN0cmV0Y2hDYW52YXMgPSAoKTogdm9pZCA9PiB7XG4gIGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICBjYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xufTtcblxuc3RyZXRjaENhbnZhcygpO1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHN0cmV0Y2hDYW52YXMpO1xuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuXG5jb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSE7XG5pZiAoIWN0eCkgY29uc29sZS5lcnJvcihcIkNhbnZhcyAnMmQnIGNvbnRleHQgaXMgbm90IHN1cHBvcnRlZC5cIik7XG5cbmV4cG9ydCB7IGN0eCB9O1xuZXhwb3J0IGRlZmF1bHQgY2FudmFzO1xuIiwiY29uc3QgZ2FtZUxvb3AgPSAoYzogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBkcmF3OiAoKSA9PiB2b2lkKTogdm9pZCA9PiB7XG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBnYW1lTG9vcChjLCBkcmF3KSk7XG4gIGMuY2xlYXJSZWN0KDAsIDAsIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICBkcmF3KCk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBnYW1lTG9vcDtcbiIsImV4cG9ydCBjb25zdCBHUkFWSVRZX1ggPSAwOyAvLyBweC9mcl4yXG5leHBvcnQgY29uc3QgR1JBVklUWV9ZID0gMTsgLy8gcHgvZnJeMlxuZXhwb3J0IGNvbnN0IEFJUl9SRVNJU1RBTkNFID0gMC4yNTsgLy8gVE9ET1xuZXhwb3J0IGNvbnN0IEZSSUNUSU9OID0gMC4yNTsgLy8gVE9ETzogdGhpcyBzaG91bGQgYmUgZGVwZW5kZW50IG9uIG1hc3NcbmV4cG9ydCBjb25zdCBOT1JNQUxfRFJBRyA9IDEwMDsgLy8gc3VyZmFjZSBhcmVhIGluIHBpeGVscywgcGVyIGtpbG9ncmFtXG4iLCJleHBvcnQgY29uc3QgcmFuZCA9IChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICBjb25zdCBbcmVhbE1pbiwgcmVhbE1heF0gPSBtaW4gPCBtYXggPyBbbWluLCBtYXhdIDogW21heCwgbWluXTtcbiAgY29uc3QgZGlmZiA9IHJlYWxNYXggLSByZWFsTWluO1xuICByZXR1cm4gcmVhbE1pbiArIChNYXRoLnJhbmRvbSgpICogZGlmZik7XG59O1xuXG5leHBvcnQgY29uc3QgcmFuZ2UgPSAobWluOiBudW1iZXIsIG1heD86IG51bWJlcik6IG51bWJlcltdID0+IHtcbiAgaWYgKCFtYXgpIHtcbiAgICBtYXggPSBtaW47IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICBtaW4gPSAwOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gIH1cbiAgY29uc3QgW3JlYWxNaW4sIHJlYWxNYXhdID0gbWluIDwgbWF4ID8gW21pbiwgbWF4XSA6IFttYXgsIG1pbl07XG4gIGNvbnN0IGRpZmYgPSByZWFsTWF4IC0gcmVhbE1pbjtcbiAgY29uc3QgYmFzZUFycmF5ID0gWy4uLkFycmF5KGRpZmYpLmtleXMoKV0ubWFwKG4gPT4gbiArIHJlYWxNaW4pO1xuICByZXR1cm4gbWF4ID49IG1pbiA/IGJhc2VBcnJheSA6IFtyZWFsTWF4LCAuLi5iYXNlQXJyYXkuc2xpY2UoMSkucmV2ZXJzZSgpXTtcbn07XG5cbmV4cG9ydCBjb25zdCBkYW1wZW4gPSAobnVtOiBudW1iZXIsIGJ5OiBudW1iZXIsIGNlbnRlciA9IDApOiBudW1iZXIgPT4ge1xuICAvLyBudW1iZXIgaXMgYWxyZWFkeSBhdCB0aGUgY2VudGVyXG4gIGlmIChudW0gPT09IGNlbnRlcikgcmV0dXJuIGNlbnRlcjtcblxuICAvLyBudW1iZXIgaXMgaGlnaGVyIHRoYW4gdGhlIGNlbnRlcjsgc3VidHJhY3QgYW5kIGRvbid0IG92ZXJzaG9vdCB0aGUgY2VudGVyXG4gIGlmIChudW0gPiBjZW50ZXIpIHtcbiAgICBjb25zdCBuZXdOdW0gPSBudW0gLSBieTtcbiAgICByZXR1cm4gbmV3TnVtIDwgY2VudGVyID8gY2VudGVyIDogbmV3TnVtO1xuICB9XG5cbiAgLy8gbnVtYmVyIGlzIGxvd2VyIHRoYW4gdGhlIGNlbnRlcjsgYWRkIGFuZCBkb24ndCBvdmVyc2hvb3QgdGhlIGNlbnRlclxuICBjb25zdCBuZXdOdW0gPSBudW0gKyBieTtcbiAgcmV0dXJuIG5ld051bSA+IGNlbnRlciA/IGNlbnRlciA6IG5ld051bTtcbn07XG5cbmV4cG9ydCBjb25zdCBib3VuZCA9IChudW06IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgY29uc3QgW3JlYWxNaW4sIHJlYWxNYXhdID0gbWluIDwgbWF4ID8gW21pbiwgbWF4XSA6IFttYXgsIG1pbl07XG4gIGlmIChudW0gPCByZWFsTWluKSByZXR1cm4gcmVhbE1pbjtcbiAgaWYgKG51bSA+IHJlYWxNYXgpIHJldHVybiByZWFsTWF4O1xuICByZXR1cm4gbnVtO1xufTtcblxuZXhwb3J0IGNvbnN0IGJldHdlZW4gPSAobnVtOiBudW1iZXIsIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciwgaW5jbHVzaXZlID0gdHJ1ZSk6IGJvb2xlYW4gPT4ge1xuICBjb25zdCBbcmVhbE1pbiwgcmVhbE1heF0gPSBtaW4gPCBtYXggPyBbbWluLCBtYXhdIDogW21heCwgbWluXTtcbiAgcmV0dXJuIGluY2x1c2l2ZSA/IChudW0gPj0gcmVhbE1pbiAmJiBudW0gPD0gcmVhbE1heCkgOiAobnVtID4gcmVhbE1pbiAmJiBudW0gPCByZWFsTWF4KTtcbn07XG4iLCJpbXBvcnQgeyBHUkFWSVRZX1gsIEdSQVZJVFlfWSwgRlJJQ1RJT04sIE5PUk1BTF9EUkFHIH0gZnJvbSBcIi4vdW5pdmVyc2VcIjtcbmltcG9ydCB7IGRhbXBlbiwgYm91bmQgfSBmcm9tIFwiLi91dGlsaXRpZXNcIjtcblxuY29uc3QgdXBkYXRlRGltZW5zaW9uID0gKFxuICBwb3NpdGlvbjogbnVtYmVyLFxuICB2ZWxvY2l0eTogbnVtYmVyLFxuICBhY2NlbGVyYXRpb246IG51bWJlcixcbiAgbWluOiBudW1iZXIsXG4gIG1heDogbnVtYmVyLFxuKTogeyBwb3NpdGlvbjogbnVtYmVyOyB2ZWxvY2l0eTogbnVtYmVyIH0gPT4ge1xuICBsZXQgbmV3UG9zaXRpb24gPSBwb3NpdGlvbiArIHZlbG9jaXR5O1xuICBsZXQgbmV3VmVsb2NpdHkgPSB2ZWxvY2l0eSArIGFjY2VsZXJhdGlvbjtcbiAgaWYgKG5ld1Bvc2l0aW9uID4gbWF4KSB7XG4gICAgbmV3UG9zaXRpb24gPSBtYXg7XG4gICAgbmV3VmVsb2NpdHkgPSAwO1xuICB9IGVsc2UgaWYgKG5ld1Bvc2l0aW9uIDwgbWluKSB7XG4gICAgbmV3UG9zaXRpb24gPSBtaW47XG4gICAgbmV3VmVsb2NpdHkgPSAwO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBwb3NpdGlvbjogbmV3UG9zaXRpb24sXG4gICAgdmVsb2NpdHk6IG5ld1ZlbG9jaXR5LFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFzcyB7XG4gIHB1YmxpYyBtYXNzID0gMTsgLy8ga2dcbiAgcHVibGljIHggPSAwOyAvLyBweFxuICBwdWJsaWMgeSA9IDA7IC8vIHB4XG4gIHB1YmxpYyBkeCA9IDA7IC8vIHB4L2ZyXG4gIHB1YmxpYyBkeSA9IDA7IC8vIHB4L2ZyXG4gIHB1YmxpYyB3aWR0aCA9IDI1O1xuICBwdWJsaWMgaGVpZ2h0ID0gMjU7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IFBhcnRpYWw8TWFzcz4pIHtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpO1xuICB9XG5cbiAgZ2V0IGRyYWdDb2VmZmljaWVudCgpOiBudW1iZXIge1xuICAgIGNvbnN0IHN1cmZhY2VBcmVhID0gKDIgKiB0aGlzLndpZHRoKSArICgyICogdGhpcy5oZWlnaHQpO1xuICAgIHJldHVybiAoc3VyZmFjZUFyZWEgLyB0aGlzLm1hc3MpIC8gTk9STUFMX0RSQUc7XG4gIH1cblxuICBnZXQgYXgoKTogbnVtYmVyIHsgcmV0dXJuIEdSQVZJVFlfWDsgfVxuICBnZXQgYXkoKTogbnVtYmVyIHsgcmV0dXJuIEdSQVZJVFlfWTsgfVxuXG4gIGdldCBpc0FnYWluc3RUb3BXYWxsKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy55ID09PSAwOyB9XG4gIGdldCBpc0FnYWluc3RCb3R0b21XYWxsKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy55ID09PSB3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmhlaWdodDsgfVxuICBnZXQgaXNBZ2FpbnN0TGVmdFdhbGwoKTogYm9vbGVhbiB7IHJldHVybiB0aGlzLnggPT09IDA7IH1cbiAgZ2V0IGlzQWdhaW5zdFJpZ2h0V2FsbCgpOiBib29sZWFuIHsgcmV0dXJuIHRoaXMueCA9PT0gd2luZG93LmlubmVyV2lkdGggLSB0aGlzLndpZHRoOyB9XG5cbiAgZ2V0IHRlcm1pbmFsVmVsb2NpdHkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gMjA7IC8vIFRPRE86IHNob3VsZCBiZSBiYXNlZCBvbiBkcmFnXG4gIH1cblxuICB1cGRhdGUoKTogdm9pZCB7XG4gICAgY29uc3QgbmV3WERpbWVuc2lvbiA9IHVwZGF0ZURpbWVuc2lvbih0aGlzLngsIHRoaXMuZHgsIHRoaXMuYXgsIHRoaXMud2lkdGgsIHdpbmRvdy5pbm5lcldpZHRoIC0gdGhpcy53aWR0aCk7XG4gICAgY29uc3QgeEZyaWN0aW9uID0gdGhpcy5pc0FnYWluc3RUb3BXYWxsIHx8IHRoaXMuaXNBZ2FpbnN0Qm90dG9tV2FsbCA/IEZSSUNUSU9OIDogMDtcbiAgICB0aGlzLnggPSBuZXdYRGltZW5zaW9uLnBvc2l0aW9uO1xuICAgIHRoaXMuZHggPSBib3VuZChkYW1wZW4obmV3WERpbWVuc2lvbi52ZWxvY2l0eSwgeEZyaWN0aW9uKSwgLTEgKiB0aGlzLnRlcm1pbmFsVmVsb2NpdHksIHRoaXMudGVybWluYWxWZWxvY2l0eSk7XG5cbiAgICBjb25zdCBuZXdZRGltZW5zaW9uID0gdXBkYXRlRGltZW5zaW9uKHRoaXMueSwgdGhpcy5keSwgdGhpcy5heSwgdGhpcy5oZWlnaHQsIHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuaGVpZ2h0KTtcbiAgICBjb25zdCB5RnJpY3Rpb24gPSB0aGlzLmlzQWdhaW5zdExlZnRXYWxsIHx8IHRoaXMuaXNBZ2FpbnN0UmlnaHRXYWxsID8gRlJJQ1RJT04gOiAwO1xuICAgIHRoaXMueSA9IG5ld1lEaW1lbnNpb24ucG9zaXRpb247XG4gICAgdGhpcy5keSA9IGJvdW5kKGRhbXBlbihuZXdZRGltZW5zaW9uLnZlbG9jaXR5LCB5RnJpY3Rpb24pLCAtMSAqIHRoaXMudGVybWluYWxWZWxvY2l0eSwgdGhpcy50ZXJtaW5hbFZlbG9jaXR5KTtcbiAgfVxuXG4gIGlzSGl0dGluZyhtYXNzOiBNYXNzKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbWFzc0xlZnQgPSBtYXNzLng7XG4gICAgY29uc3QgbWFzc1JpZ2h0ID0gbWFzcy54ICsgbWFzcy53aWR0aDtcbiAgICBjb25zdCBtYXNzVG9wID0gbWFzcy55O1xuICAgIGNvbnN0IG1hc3NCb3R0b20gPSBtYXNzLnkgKyBtYXNzLmhlaWdodDtcblxuICAgIGNvbnN0IHRoaXNMZWZ0ID0gdGhpcy54O1xuICAgIGNvbnN0IHRoaXNSaWdodCA9IHRoaXMueCArIHRoaXMud2lkdGg7XG4gICAgY29uc3QgdGhpc1RvcCA9IHRoaXMueTtcbiAgICBjb25zdCB0aGlzQm90dG9tID0gdGhpcy55ICsgdGhpcy5oZWlnaHQ7XG5cbiAgICByZXR1cm4gKFxuICAgICAgdGhpc1JpZ2h0ID49IG1hc3NMZWZ0XG4gICAgICAmJiB0aGlzTGVmdCA8PSBtYXNzUmlnaHRcbiAgICAgICYmIHRoaXNCb3R0b20gPj0gbWFzc1RvcFxuICAgICAgJiYgdGhpc1RvcCA8PSBtYXNzQm90dG9tXG4gICAgKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIE1vdXNlIHtcbiAgcHVibGljIHggPSAwO1xuICBwdWJsaWMgeSA9IDA7XG4gIHB1YmxpYyBwcmVzc2VkID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5wb3B1bGF0ZUZyb21Nb3VzZUV2ZW50KGV2ZW50KTtcbiAgICB9KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLnBvcHVsYXRlRnJvbU1vdXNlRXZlbnQoZXZlbnQpO1xuICAgIH0pO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLnBvcHVsYXRlRnJvbU1vdXNlRXZlbnQoZXZlbnQpO1xuICAgIH0pO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMucG9wdWxhdGVGcm9tVG91Y2hFdmVudChldmVudCk7XG4gICAgfSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5wb3B1bGF0ZUZyb21Ub3VjaEV2ZW50KGV2ZW50KTtcbiAgICB9KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMucG9wdWxhdGVGcm9tVG91Y2hFdmVudChldmVudCk7XG4gICAgfSk7XG4gIH1cblxuICBwb3B1bGF0ZUZyb21Nb3VzZUV2ZW50KGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy54ID0gZXZlbnQueDtcbiAgICB0aGlzLnkgPSBldmVudC55O1xuICAgIHRoaXMucHJlc3NlZCA9IGV2ZW50LmJ1dHRvbnMgPT09IDE7XG4gIH1cblxuICBwb3B1bGF0ZUZyb21Ub3VjaEV2ZW50KGV2ZW50OiBUb3VjaEV2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgeyB0b3VjaGVzIH0gPSBldmVudDtcbiAgICBpZiAodG91Y2hlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMucHJlc3NlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB0b3VjaCA9IHRvdWNoZXNbMF07XG4gICAgICB0aGlzLnggPSB0b3VjaC5jbGllbnRYO1xuICAgICAgdGhpcy55ID0gdG91Y2guY2xpZW50WTtcbiAgICAgIHRoaXMucHJlc3NlZCA9IHRydWU7XG4gICAgfVxuICB9XG59XG5cbmNvbnN0IG1vdXNlID0gbmV3IE1vdXNlKCk7XG5cbmV4cG9ydCBkZWZhdWx0IG1vdXNlO1xuIiwiLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cblxuaW1wb3J0IHsgY3R4IH0gZnJvbSAnLi9jYW52YXMnO1xuaW1wb3J0IGdhbWVMb29wIGZyb20gJy4vZ2FtZUxvb3AnO1xuaW1wb3J0IE1hc3MgZnJvbSAnLi9NYXNzJztcbmltcG9ydCBQbGF5ZXIgZnJvbSAnLi9QbGF5ZXInO1xuaW1wb3J0IHsgcmFuZ2UsIHJhbmQgfSBmcm9tICcuL3V0aWxpdGllcyc7XG5cbmNvbnN0IHBsYXllciA9IG5ldyBQbGF5ZXIoKTtcblxuY29uc3QgbWFzc2VzID0gcmFuZ2UoMTApLm1hcCgoKSA9PiB7XG4gIHJldHVybiBuZXcgTWFzcyh7XG4gICAgbWFzczogcmFuZCgwLjUsIDUpLFxuICAgIHg6IHJhbmQoMCwgd2luZG93LmlubmVyV2lkdGgpLFxuICAgIHk6IHJhbmQoMCwgd2luZG93LmlubmVySGVpZ2h0KSxcbiAgICB3aWR0aDogcmFuZCg1MCwgMTUwKSxcbiAgICBoZWlnaHQ6IHJhbmQoNTAsIDE1MCksXG4gIH0pO1xufSk7XG5cbmNvbnN0IHN0YXJzID0gcmFuZ2UoMTAwKS5tYXAoKCkgPT4ge1xuICBjb25zdCBzaXplID0gcmFuZCgxLCA1KTtcbiAgcmV0dXJuIFtcbiAgICByYW5kKDAsIHdpbmRvdy5pbm5lcldpZHRoKSxcbiAgICByYW5kKDAsIHdpbmRvdy5pbm5lckhlaWdodCksXG4gICAgc2l6ZSxcbiAgICBzaXplLFxuICBdIGFzIGNvbnN0O1xufSk7XG5cbmdhbWVMb29wKGN0eCwgKCkgPT4ge1xuICBzdGFycy5mb3JFYWNoKChyZWN0T3B0aW9ucywgaW5kZXgpID0+IHtcbiAgICBjb25zdCBvcGFjaXR5ID0gKChpbmRleCAlIDEwKSArIDEpIC8gMTA7XG4gICAgY3R4LmZpbGxTdHlsZSA9IGByZ2JhKDI1NSwgMjU1LCAyNTUsICR7b3BhY2l0eX0pYDtcbiAgICBjdHguZmlsbFJlY3QoLi4ucmVjdE9wdGlvbnMpO1xuICB9KTtcblxuICBtYXNzZXMuZm9yRWFjaCgobWFzcykgPT4ge1xuICAgIGlmIChwbGF5ZXIuaXNIaXR0aW5nKG1hc3MpKSB7XG4gICAgICBjdHguZmlsbFN0eWxlID0gJ3JnYmEoMjU1LCAwLCAwLCAwLjIpJztcbiAgICB9IGVsc2Uge1xuICAgICAgY3R4LmZpbGxTdHlsZSA9ICdyZ2JhKDI1NSwgMCwgMCwgMC41KSc7XG4gICAgfVxuXG4gICAgY3R4LmZpbGxSZWN0KG1hc3MueCwgbWFzcy55LCBtYXNzLndpZHRoLCBtYXNzLmhlaWdodCk7XG4gIH0pO1xuXG4gIGN0eC5maWxsU3R5bGUgPSAncmdiYSgwLCAxNTAsIDAsIDEpJztcbiAgY3R4LmZpbGxSZWN0KHBsYXllci54LCBwbGF5ZXIueSwgcGxheWVyLndpZHRoLCBwbGF5ZXIuaGVpZ2h0KTtcblxuICBjb25zdCBmYWNlbWFza0NvbG9yID0gJ3JnYmEoMjIwLCAyMjAsIDI1NSwgMSknO1xuICBjb25zdCBmYWNlbWFza1dpZHRoID0gcGxheWVyLndpZHRoIC8gMjtcbiAgY29uc3QgZmFjZW1hc2tIZWlnaHQgPSBwbGF5ZXIuaGVpZ2h0IC8gNTtcbiAgY29uc3QgZmFjZW1hc2tPZmZzZXRZID0gMztcbiAgY3R4LmZpbGxTdHlsZSA9IGZhY2VtYXNrQ29sb3I7XG4gIHN3aXRjaCAocGxheWVyLmJ1cm5lclhTaWRlKSB7XG4gICAgY2FzZSAnbGVmdCc6IGN0eC5maWxsUmVjdChwbGF5ZXIueCArIChwbGF5ZXIud2lkdGggLSBmYWNlbWFza1dpZHRoKSwgcGxheWVyLnkgKyBmYWNlbWFza09mZnNldFksIGZhY2VtYXNrV2lkdGgsIGZhY2VtYXNrSGVpZ2h0KTsgYnJlYWs7XG4gICAgY2FzZSAncmlnaHQnOiBjdHguZmlsbFJlY3QocGxheWVyLngsIHBsYXllci55ICsgZmFjZW1hc2tPZmZzZXRZLCBmYWNlbWFza1dpZHRoLCBmYWNlbWFza0hlaWdodCk7IGJyZWFrO1xuICAgIGRlZmF1bHQ6IGN0eC5maWxsUmVjdChwbGF5ZXIueCArICgocGxheWVyLndpZHRoIC0gZmFjZW1hc2tXaWR0aCkgLyAyKSwgcGxheWVyLnkgKyBmYWNlbWFza09mZnNldFksIGZhY2VtYXNrV2lkdGgsIGZhY2VtYXNrSGVpZ2h0KTsgYnJlYWs7XG4gIH1cblxuICBjb25zdCBidXJuZXJDb2xvciA9IGByZ2JhKDI1NSwgMTAwLCAwLCAke3JhbmQoMC41LCAwLjc1KX0pYDtcbiAgY29uc3QgYnVybmVyTGVuZ3RoWCA9IHJhbmQoMC4yNSwgMC40KSAqIHBsYXllci53aWR0aDtcbiAgY29uc3QgYnVybmVyTGVuZ3RoWSA9IHJhbmQoMC40LCAwLjYpICogcGxheWVyLmhlaWdodDtcbiAgY29uc3QgYnVybmVyQWNyb3NzID0gKHdpZHRoOiBudW1iZXIpOiBudW1iZXIgPT4gMC42ICogd2lkdGg7XG4gIGNvbnN0IGJ1cm5lckFjcm9zc09mZnNldCA9ICh3aWR0aDogbnVtYmVyKTogbnVtYmVyID0+ICh3aWR0aCAtIGJ1cm5lckFjcm9zcyh3aWR0aCkpIC8gMjtcblxuICBjdHguZmlsbFN0eWxlID0gYnVybmVyQ29sb3I7XG4gIHN3aXRjaCAocGxheWVyLmJ1cm5lclhTaWRlKSB7XG4gICAgY2FzZSAnbGVmdCc6IGN0eC5maWxsUmVjdChcbiAgICAgIHBsYXllci54IC0gYnVybmVyTGVuZ3RoWCwgLy8gcG9zaXRpb25lZCBvbiB0aGUgbGVmdCBzaWRlIG9mIHRoZSBwbGF5ZXJcbiAgICAgIHBsYXllci55ICsgYnVybmVyQWNyb3NzT2Zmc2V0KHBsYXllci5oZWlnaHQpLCAvLyBjZW50ZXJlZCBvbiB0aGUgWSBheGlzXG4gICAgICBidXJuZXJMZW5ndGhYLCAvLyBsb25nIHRhaWwgb3JpZW50ZWQgYWxvbmcgdGhlIFggYXhpc1xuICAgICAgYnVybmVyQWNyb3NzKHBsYXllci5oZWlnaHQpLCAvLyBjcm9zcy1zZWN0aW9uIG9yaWVudGVkIGFsb25nIHRoZSBZIGF4aXNcbiAgICApOyBicmVhaztcbiAgICBjYXNlICdyaWdodCc6IGN0eC5maWxsUmVjdChcbiAgICAgIHBsYXllci54ICsgcGxheWVyLndpZHRoLCAvLyBwb3NpdGlvbmVkIG9uIHRoZSByaWdodCBzaWRlIG9mIHRoZSBwbGF5ZXJcbiAgICAgIHBsYXllci55ICsgYnVybmVyQWNyb3NzT2Zmc2V0KHBsYXllci5oZWlnaHQpLCAvLyBjZW50ZXJlZCBvbiB0aGUgWSBheGlzXG4gICAgICBidXJuZXJMZW5ndGhYLCAvLyBsb25nIHRhaWwgb3JpZW50ZWQgYWxvbmcgdGhlIFggYXhpc1xuICAgICAgYnVybmVyQWNyb3NzKHBsYXllci5oZWlnaHQpLCAvLyBjcm9zcy1zZWN0aW9uIG9yaWVudGVkIGFsb25nIHRoZSBZIGF4aXNcbiAgICApOyBicmVhaztcbiAgICBkZWZhdWx0OiBicmVhaztcbiAgfVxuICBzd2l0Y2ggKHBsYXllci5idXJuZXJZU2lkZSkge1xuICAgIGNhc2UgJ2JvdHRvbSc6IGN0eC5maWxsUmVjdChcbiAgICAgIHBsYXllci54ICsgYnVybmVyQWNyb3NzT2Zmc2V0KHBsYXllci53aWR0aCksIC8vIGNlbnRlcmVkIG9uIHRoZSBYIGF4aXNcbiAgICAgIHBsYXllci55ICsgcGxheWVyLmhlaWdodCwgLy8gcG9zaXRpb25lZCBvbiB0aGUgYm90dG9tIG9mIHRoZSBwbGF5ZXJcbiAgICAgIGJ1cm5lckFjcm9zcyhwbGF5ZXIud2lkdGgpLCAvLyBjcm9zcy1zZWN0aW9uIG9yaWVudGVkIGFsb25nIHRoZSBYIGF4aXNcbiAgICAgIGJ1cm5lckxlbmd0aFksIC8vIGxvbmcgdGFpbCBvcmllbnRlZCBhbG9uZyB0aGUgWSBheGlzXG4gICAgKTsgYnJlYWs7XG4gICAgY2FzZSAndG9wJzogY3R4LmZpbGxSZWN0KFxuICAgICAgcGxheWVyLnggKyBidXJuZXJBY3Jvc3NPZmZzZXQocGxheWVyLndpZHRoKSwgLy8gY2VudGVyZWQgb24gdGhlIFggYXhpc1xuICAgICAgcGxheWVyLnkgLSBidXJuZXJMZW5ndGhZLCAvLyBwb3NpdGlvbmVkIG9uIHRoZSB0b3Agb2YgdGhlIHBsYXllclxuICAgICAgYnVybmVyQWNyb3NzKHBsYXllci53aWR0aCksIC8vIGNyb3NzLXNlY3Rpb24gb3JpZW50ZWQgYWxvbmcgdGhlIFggYXhpc1xuICAgICAgYnVybmVyTGVuZ3RoWSwgLy8gbG9uZyB0YWlsIG9yaWVudGVkIGFsb25nIHRoZSBZIGF4aXNcbiAgICApOyBicmVhaztcbiAgICBkZWZhdWx0OiBicmVhaztcbiAgfVxuXG4gIHBsYXllci51cGRhdGUoKTtcbn0pO1xuIiwiaW1wb3J0IE1hc3MgZnJvbSBcIi4vTWFzc1wiO1xuaW1wb3J0IG1vdXNlIGZyb20gXCIuL21vdXNlXCI7XG5pbXBvcnQgeyBiZXR3ZWVuIH0gZnJvbSBcIi4vdXRpbGl0aWVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYXllciBleHRlbmRzIE1hc3Mge1xuICBwdWJsaWMgd2lkdGggPSAxNTtcbiAgcHVibGljIGhlaWdodCA9IDIwO1xuICBwdWJsaWMgamV0cGFja0ZvcmNlWCA9IDAuNDsgLy8gKGtnICogcHgpIC8gZnJeMlxuICBwdWJsaWMgamV0cGFja0ZvcmNlWSA9IDEuMzsgLy8gKGtnICogcHgpIC8gZnJeMlxuXG4gIGdldCBidXJuaW5nKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBtb3VzZS5wcmVzc2VkO1xuICB9XG5cbiAgZ2V0IGpldHBhY2tBY2NlbGVyYXRpb25YKCk6IG51bWJlciB7XG4gICAgaWYgKCF0aGlzLmJ1cm5pbmcpIHJldHVybiAwO1xuXG4gICAgY29uc3QgbW91c2VEaXN0YW5jZSA9IG1vdXNlLnggLSB0aGlzLng7XG4gICAgY29uc3QgbGVmdE1hcmdpbiA9IC0xICogdGhpcy53aWR0aDtcbiAgICBjb25zdCByaWdodE1hcmdpbiA9IDIgKiB0aGlzLndpZHRoO1xuICAgIGlmIChiZXR3ZWVuKG1vdXNlRGlzdGFuY2UsIGxlZnRNYXJnaW4sIHJpZ2h0TWFyZ2luKSkgcmV0dXJuIDA7XG5cbiAgICBjb25zdCBqZXRwYWNrQWNjZWxlcmF0aW9uID0gdGhpcy5qZXRwYWNrRm9yY2VYIC8gdGhpcy5tYXNzO1xuICAgIHJldHVybiBtb3VzZURpc3RhbmNlID4gMCA/IGpldHBhY2tBY2NlbGVyYXRpb24gOiAtMSAqIGpldHBhY2tBY2NlbGVyYXRpb247XG4gIH1cblxuICBnZXQgamV0cGFja0FjY2VsZXJhdGlvblkoKTogbnVtYmVyIHtcbiAgICBpZiAoIXRoaXMuYnVybmluZykgcmV0dXJuIDA7XG5cbiAgICBjb25zdCBtb3VzZURpc3RhbmNlID0gbW91c2UueSAtIHRoaXMueTtcbiAgICBjb25zdCB0b3BNYXJnaW4gPSAwO1xuICAgIGNvbnN0IGJvdHRvbU1hcmdpbiA9IHRoaXMuaGVpZ2h0O1xuICAgIGlmIChtb3VzZURpc3RhbmNlID49IDAgfHwgYmV0d2Vlbihtb3VzZURpc3RhbmNlLCB0b3BNYXJnaW4sIGJvdHRvbU1hcmdpbikpIHJldHVybiAwO1xuXG4gICAgY29uc3QgamV0cGFja0FjY2VsZXJhdGlvbiA9IHRoaXMuamV0cGFja0ZvcmNlWSAvIHRoaXMubWFzcztcbiAgICByZXR1cm4gLTEgKiBqZXRwYWNrQWNjZWxlcmF0aW9uO1xuICB9XG5cbiAgZ2V0IGF4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHN1cGVyLmF4ICsgdGhpcy5qZXRwYWNrQWNjZWxlcmF0aW9uWDtcbiAgfVxuXG4gIGdldCBheSgpOiBudW1iZXIge1xuICAgIHJldHVybiBzdXBlci5heSArIHRoaXMuamV0cGFja0FjY2VsZXJhdGlvblk7XG4gIH1cblxuICBnZXQgYnVybmVyWFNpZGUoKTogJ2xlZnQnfCdub25lJ3wncmlnaHQnIHtcbiAgICBpZiAodGhpcy5qZXRwYWNrQWNjZWxlcmF0aW9uWCA9PT0gMCkgcmV0dXJuICdub25lJztcbiAgICByZXR1cm4gdGhpcy5qZXRwYWNrQWNjZWxlcmF0aW9uWCA+IDAgPyAnbGVmdCcgOiAncmlnaHQnO1xuICB9XG5cbiAgZ2V0IGJ1cm5lcllTaWRlKCk6ICdib3R0b20nfCdub25lJ3wndG9wJyB7XG4gICAgaWYgKHRoaXMuamV0cGFja0FjY2VsZXJhdGlvblkgPT09IDApIHJldHVybiAnbm9uZSc7XG4gICAgcmV0dXJuIHRoaXMuamV0cGFja0FjY2VsZXJhdGlvblkgPiAwID8gJ3RvcCcgOiAnYm90dG9tJztcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==