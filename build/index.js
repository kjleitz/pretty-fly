!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const r=document.createElement("canvas"),s=()=>{r.width=window.innerWidth,r.height=window.innerHeight};s(),window.addEventListener("resize",s),document.body.appendChild(r);const o=r.getContext("2d");o||console.error("Canvas '2d' context is not supported.");const n=(t,e)=>{requestAnimationFrame(()=>n(t,e)),t.clearRect(0,0,window.innerWidth,window.innerHeight),e()};var h=n;const a=(t,e)=>{const[i,r]=t<e?[t,e]:[e,t],s=r-i;return i+Math.random()*s},l=(t,e)=>{e||(e=t,t=0);const[i,r]=t<e?[t,e]:[e,t],s=[...Array(r-i).keys()].map(t=>t+i);return e>=t?s:[r,...s.slice(1).reverse()]},c=(t,e,i=0)=>{if(t===i)return i;if(t>i){const r=t-e;return r<i?i:r}const r=t+e;return r>i?i:r},u=(t,e,i)=>{const[r,s]=e<i?[e,i]:[i,e];return t<r?r:t>s?s:t},d=(t,e,i,r=!0)=>{const[s,o]=e<i?[e,i]:[i,e];return r?t>=s&&t<=o:t>s&&t<o},g=(t,e)=>Math.abs(t-e),p=0,f=1,w=.25,y=100;var m=new class{constructor(){this.masses=[]}overlapForMove(t,e){const i=new x(Object.assign(Object.assign(Object.assign({},t),e),{darkMatter:!0})),r=i.x-t.x,s=i.y-t.y,o=s<0,n=s>0,h=r<0,a=r>0;return this.masses.reduce((e,r)=>{if(r===t)return e;if(!i.isHitting(r))return e;if(o&&d(r.bottom,t.top,i.top)){const t=g(r.bottom,i.top);e.top<t&&(e.top=t)}if(n&&d(r.top,t.bottom,i.bottom)){const t=g(r.top,i.bottom);e.bottom<t&&(e.bottom=t)}if(h&&d(r.right,t.left,i.left)){const t=g(r.right,i.left);e.left<t&&(e.left=t)}if(a&&d(r.left,t.right,i.right)){const t=g(r.left,i.right);e.right<t&&(e.right=t)}return e},{top:0,bottom:0,left:0,right:0})}overlappingMasses(t,{ignore:e=[]}={}){return this.masses.filter(i=>t!==i&&!e.includes(i)&&t.isHitting(i))}overlap(t,{ignore:e=[]}={}){return this.overlappingMasses(t,{ignore:e}).reduce((e,i)=>{const r=e;if(i.top>=t.top&&i.top<=t.bottom){const e=t.bottom-i.top;r.bottom<e&&(r.bottom=e)}if(i.bottom<=t.bottom&&i.bottom>=t.top){const e=i.bottom-t.top;r.top<e&&(r.top=e)}if(i.left>=t.left&&i.left<=t.right){const e=t.right-i.left;r.right<e&&(r.right=e)}if(i.right>=t.left&&i.right<=t.right){const e=i.right-t.left;r.left<e&&(r.left=e)}return r},{top:0,right:0,bottom:0,left:0})}};const b=(t,e,i,r,s)=>{let o=t+e,n=e+i;return o>s?(o=s,n=0):o<r&&(o=r,n=0),{position:o,velocity:n}};class x{constructor(t){this.mass=1,this.x=0,this.y=0,this.dx=0,this.dy=0,this.width=25,this.height=25,this.stationary=!1,this.darkMatter=!1,Object.assign(this,t),this.darkMatter||m.masses.push(this)}get dragCoefficient(){return(2*this.width+2*this.height)/this.mass/y}get ax(){return this.stationary?0:p}get ay(){return this.stationary?0:f}get isAgainstTopWall(){return 0===this.y}get isAgainstBottomWall(){return this.y===window.innerHeight-this.height}get isAgainstLeftWall(){return 0===this.x}get isAgainstRightWall(){return this.x===window.innerWidth-this.width}get terminalVelocity(){return 20}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get left(){return this.x}update(){const t=b(this.x,this.dx,this.ax,this.width,window.innerWidth-this.width),e=b(this.y,this.dy,this.ay,this.height,window.innerHeight-this.height);let i=t.position,r=e.position,s=t.velocity,o=e.velocity;const n=m.overlapForMove(this,{x:i,y:r});n.right>0?(i-=n.right,s=0):n.left>0&&(i+=n.left,s=0),n.bottom>0?(r-=n.bottom,o=0):n.top>0&&(r+=n.top,o=0),this.x=i,this.y=r,(this.isAgainstTopWall||this.isAgainstBottomWall||n.top||n.bottom)&&(s=c(s,w)),(this.isAgainstLeftWall||this.isAgainstRightWall||n.left||n.right)&&(o=c(o,w)),this.dx=u(s,-1*this.terminalVelocity,this.terminalVelocity),this.dy=u(o,-1*this.terminalVelocity,this.terminalVelocity)}isHitting(t){return this.right>=t.left&&this.left<=t.right&&this.bottom>=t.top&&this.top<=t.bottom}}var v=new class{constructor(){this.x=0,this.y=0,this.pressed=!1,window.addEventListener("mousedown",t=>{this.populateFromMouseEvent(t)}),window.addEventListener("mousemove",t=>{this.populateFromMouseEvent(t)}),window.addEventListener("mouseup",t=>{this.populateFromMouseEvent(t)}),window.addEventListener("touchstart",t=>{this.populateFromTouchEvent(t)}),window.addEventListener("touchmove",t=>{this.populateFromTouchEvent(t)}),window.addEventListener("touchend",t=>{this.populateFromTouchEvent(t)})}populateFromMouseEvent(t){this.x=t.x,this.y=t.y,this.pressed=1===t.buttons}populateFromTouchEvent(t){const{touches:e}=t;if(0===e.length)this.pressed=!1;else{const t=e[0];this.x=t.clientX,this.y=t.clientY,this.pressed=!0}}};const k=new class extends x{constructor(){super(...arguments),this.width=15,this.height=20,this.jetpackForceX=.4,this.jetpackForceY=1.3}get burning(){return v.pressed}get axJetpack(){if(!this.burning)return 0;const t=v.x-this.x,e=-1*this.width,i=2*this.width;if(d(t,e,i))return 0;const r=this.jetpackForceX/this.mass;return t>0?r:-1*r}get ayJetpack(){if(!this.burning)return 0;const t=v.y-this.y,e=this.height;return t>=0||d(t,0,e)?0:-1*(this.jetpackForceY/this.mass)}get ax(){return super.ax+this.axJetpack}get ay(){return super.ay+this.ayJetpack}get burnerXSide(){return 0===this.axJetpack?"none":this.axJetpack>0?"left":"right"}get burnerYSide(){return 0===this.ayJetpack?"none":this.ayJetpack>0?"top":"bottom"}},E=l(10).map(()=>new x({mass:a(.5,5),x:a(0,window.innerWidth),y:a(0,window.innerHeight),width:a(50,150),height:a(50,150),stationary:!0})),M=l(100).map(()=>{const t=a(1,5);return[a(0,window.innerWidth),a(0,window.innerHeight),t,t]});h(o,()=>{M.forEach((t,e)=>{const i=(e%10+1)/10;o.fillStyle=`rgba(255, 255, 255, ${i})`,o.fillRect(...t)}),E.forEach(t=>{k.isHitting(t)?o.fillStyle="rgba(255, 0, 0, 0.2)":o.fillStyle="rgba(255, 0, 0, 0.5)",o.fillRect(t.x,t.y,t.width,t.height)}),o.fillStyle="rgba(0, 150, 0, 1)",o.fillRect(k.x,k.y,k.width,k.height);const t=k.width/2,e=k.height/5;switch(o.fillStyle="rgba(220, 220, 255, 1)",k.burnerXSide){case"left":o.fillRect(k.x+(k.width-t),k.y+3,t,e);break;case"right":o.fillRect(k.x,k.y+3,t,e);break;default:o.fillRect(k.x+(k.width-t)/2,k.y+3,t,e)}const i=`rgba(255, 100, 0, ${a(.5,.75)})`,r=a(.25,.4)*k.width,s=a(.4,.6)*k.height,n=t=>.6*t,h=t=>(t-n(t))/2;switch(o.fillStyle=i,k.burnerXSide){case"left":o.fillRect(k.x-r,k.y+h(k.height),r,n(k.height));break;case"right":o.fillRect(k.x+k.width,k.y+h(k.height),r,n(k.height))}switch(k.burnerYSide){case"bottom":o.fillRect(k.x+h(k.width),k.y+k.height,n(k.width),s);break;case"top":o.fillRect(k.x+h(k.width),k.y-s,n(k.width),s)}k.update()})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZUxvb3AudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxpdGllcy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdW5pdmVyc2UudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hc3MudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vdXNlLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUGxheWVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3RyZXRjaENhbnZhcyIsIndpZHRoIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImhlaWdodCIsImlubmVySGVpZ2h0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImN0eCIsImdldENvbnRleHQiLCJjb25zb2xlIiwiZXJyb3IiLCJnYW1lTG9vcCIsImRyYXciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjbGVhclJlY3QiLCJyYW5kIiwibWluIiwibWF4IiwicmVhbE1pbiIsInJlYWxNYXgiLCJkaWZmIiwiTWF0aCIsInJhbmRvbSIsInJhbmdlIiwiYmFzZUFycmF5IiwiQXJyYXkiLCJrZXlzIiwibWFwIiwic2xpY2UiLCJyZXZlcnNlIiwiZGFtcGVuIiwibnVtIiwiYnkiLCJjZW50ZXIiLCJuZXdOdW0iLCJib3VuZCIsImJldHdlZW4iLCJpbmNsdXNpdmUiLCJkaWZmZXJlbmNlIiwiYWJzIiwiR1JBVklUWV9YIiwiR1JBVklUWV9ZIiwiRlJJQ1RJT04iLCJOT1JNQUxfRFJBRyIsIm1hc3NlcyIsInN1YmplY3QiLCJ0b1Bvc2l0aW9uIiwibW92ZWRTdWJqZWN0IiwiZGFya01hdHRlciIsImR4IiwieCIsImR5IiwieSIsIm1vdmluZyIsInRoaXMiLCJyZWR1Y2UiLCJvdmVybGFwIiwib2JzdGFjbGUiLCJpc0hpdHRpbmciLCJib3R0b20iLCJ0b3AiLCJkaXN0YW5jZSIsInJpZ2h0IiwibGVmdCIsImlnbm9yZSIsImZpbHRlciIsIm1hc3MiLCJpbmNsdWRlcyIsIm92ZXJsYXBwaW5nTWFzc2VzIiwibWVtbyIsInVwZGF0ZURpbWVuc2lvbiIsInBvc2l0aW9uIiwidmVsb2NpdHkiLCJhY2NlbGVyYXRpb24iLCJuZXdQb3NpdGlvbiIsIm5ld1ZlbG9jaXR5Iiwib3B0aW9ucyIsInN0YXRpb25hcnkiLCJhc3NpZ24iLCJwdXNoIiwibmV3WERhdGEiLCJheCIsIm5ld1lEYXRhIiwiYXkiLCJuZXdYIiwibmV3WSIsIm5ld0R4IiwibmV3RHkiLCJvdmVybGFwRm9yTW92ZSIsImlzQWdhaW5zdFRvcFdhbGwiLCJpc0FnYWluc3RCb3R0b21XYWxsIiwiaXNBZ2FpbnN0TGVmdFdhbGwiLCJpc0FnYWluc3RSaWdodFdhbGwiLCJ0ZXJtaW5hbFZlbG9jaXR5IiwicHJlc3NlZCIsImV2ZW50IiwicG9wdWxhdGVGcm9tTW91c2VFdmVudCIsInBvcHVsYXRlRnJvbVRvdWNoRXZlbnQiLCJidXR0b25zIiwidG91Y2hlcyIsImxlbmd0aCIsInRvdWNoIiwiY2xpZW50WCIsImNsaWVudFkiLCJwbGF5ZXIiLCJqZXRwYWNrRm9yY2VYIiwiamV0cGFja0ZvcmNlWSIsImJ1cm5pbmciLCJtb3VzZURpc3RhbmNlIiwibGVmdE1hcmdpbiIsInJpZ2h0TWFyZ2luIiwiamV0cGFja0FjY2VsZXJhdGlvbiIsImJvdHRvbU1hcmdpbiIsInN1cGVyIiwiYXhKZXRwYWNrIiwiYXlKZXRwYWNrIiwic3RhcnMiLCJzaXplIiwiZm9yRWFjaCIsInJlY3RPcHRpb25zIiwiaW5kZXgiLCJvcGFjaXR5IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJmYWNlbWFza1dpZHRoIiwiZmFjZW1hc2tIZWlnaHQiLCJidXJuZXJYU2lkZSIsImJ1cm5lckNvbG9yIiwiYnVybmVyTGVuZ3RoWCIsImJ1cm5lckxlbmd0aFkiLCJidXJuZXJBY3Jvc3MiLCJidXJuZXJBY3Jvc3NPZmZzZXQiLCJidXJuZXJZU2lkZSIsInVwZGF0ZSJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFB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bnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cbmNvbnN0IHN0cmV0Y2hDYW52YXMgPSAoKTogdm9pZCA9PiB7XG4gIGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICBjYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xufTtcblxuc3RyZXRjaENhbnZhcygpO1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHN0cmV0Y2hDYW52YXMpO1xuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuXG5jb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSE7XG5pZiAoIWN0eCkgY29uc29sZS5lcnJvcihcIkNhbnZhcyAnMmQnIGNvbnRleHQgaXMgbm90IHN1cHBvcnRlZC5cIik7XG5cbmV4cG9ydCB7IGN0eCB9O1xuZXhwb3J0IGRlZmF1bHQgY2FudmFzO1xuIiwiY29uc3QgZ2FtZUxvb3AgPSAoYzogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBkcmF3OiAoKSA9PiB2b2lkKTogdm9pZCA9PiB7XG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBnYW1lTG9vcChjLCBkcmF3KSk7XG4gIGMuY2xlYXJSZWN0KDAsIDAsIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICBkcmF3KCk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBnYW1lTG9vcDtcbiIsImV4cG9ydCBjb25zdCByYW5kID0gKG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciA9PiB7XG4gIGNvbnN0IFtyZWFsTWluLCByZWFsTWF4XSA9IG1pbiA8IG1heCA/IFttaW4sIG1heF0gOiBbbWF4LCBtaW5dO1xuICBjb25zdCBkaWZmID0gcmVhbE1heCAtIHJlYWxNaW47XG4gIHJldHVybiByZWFsTWluICsgKE1hdGgucmFuZG9tKCkgKiBkaWZmKTtcbn07XG5cbmV4cG9ydCBjb25zdCByYW5nZSA9IChtaW46IG51bWJlciwgbWF4PzogbnVtYmVyKTogbnVtYmVyW10gPT4ge1xuICBpZiAoIW1heCkge1xuICAgIG1heCA9IG1pbjsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgIG1pbiA9IDA7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgfVxuICBjb25zdCBbcmVhbE1pbiwgcmVhbE1heF0gPSBtaW4gPCBtYXggPyBbbWluLCBtYXhdIDogW21heCwgbWluXTtcbiAgY29uc3QgZGlmZiA9IHJlYWxNYXggLSByZWFsTWluO1xuICBjb25zdCBiYXNlQXJyYXkgPSBbLi4uQXJyYXkoZGlmZikua2V5cygpXS5tYXAobiA9PiBuICsgcmVhbE1pbik7XG4gIHJldHVybiBtYXggPj0gbWluID8gYmFzZUFycmF5IDogW3JlYWxNYXgsIC4uLmJhc2VBcnJheS5zbGljZSgxKS5yZXZlcnNlKCldO1xufTtcblxuZXhwb3J0IGNvbnN0IGRhbXBlbiA9IChudW06IG51bWJlciwgYnk6IG51bWJlciwgY2VudGVyID0gMCk6IG51bWJlciA9PiB7XG4gIC8vIG51bWJlciBpcyBhbHJlYWR5IGF0IHRoZSBjZW50ZXJcbiAgaWYgKG51bSA9PT0gY2VudGVyKSByZXR1cm4gY2VudGVyO1xuXG4gIC8vIG51bWJlciBpcyBoaWdoZXIgdGhhbiB0aGUgY2VudGVyOyBzdWJ0cmFjdCBhbmQgZG9uJ3Qgb3ZlcnNob290IHRoZSBjZW50ZXJcbiAgaWYgKG51bSA+IGNlbnRlcikge1xuICAgIGNvbnN0IG5ld051bSA9IG51bSAtIGJ5O1xuICAgIHJldHVybiBuZXdOdW0gPCBjZW50ZXIgPyBjZW50ZXIgOiBuZXdOdW07XG4gIH1cblxuICAvLyBudW1iZXIgaXMgbG93ZXIgdGhhbiB0aGUgY2VudGVyOyBhZGQgYW5kIGRvbid0IG92ZXJzaG9vdCB0aGUgY2VudGVyXG4gIGNvbnN0IG5ld051bSA9IG51bSArIGJ5O1xuICByZXR1cm4gbmV3TnVtID4gY2VudGVyID8gY2VudGVyIDogbmV3TnVtO1xufTtcblxuZXhwb3J0IGNvbnN0IGJvdW5kID0gKG51bTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICBjb25zdCBbcmVhbE1pbiwgcmVhbE1heF0gPSBtaW4gPCBtYXggPyBbbWluLCBtYXhdIDogW21heCwgbWluXTtcbiAgaWYgKG51bSA8IHJlYWxNaW4pIHJldHVybiByZWFsTWluO1xuICBpZiAobnVtID4gcmVhbE1heCkgcmV0dXJuIHJlYWxNYXg7XG4gIHJldHVybiBudW07XG59O1xuXG5leHBvcnQgY29uc3QgYmV0d2VlbiA9IChudW06IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyLCBpbmNsdXNpdmUgPSB0cnVlKTogYm9vbGVhbiA9PiB7XG4gIGNvbnN0IFtyZWFsTWluLCByZWFsTWF4XSA9IG1pbiA8IG1heCA/IFttaW4sIG1heF0gOiBbbWF4LCBtaW5dO1xuICByZXR1cm4gaW5jbHVzaXZlID8gKG51bSA+PSByZWFsTWluICYmIG51bSA8PSByZWFsTWF4KSA6IChudW0gPiByZWFsTWluICYmIG51bSA8IHJlYWxNYXgpO1xufTtcblxuZXhwb3J0IGNvbnN0IGRpZmZlcmVuY2UgPSAobjogbnVtYmVyLCBtOiBudW1iZXIpOiBudW1iZXIgPT4gTWF0aC5hYnMobiAtIG0pO1xuIiwiaW1wb3J0IE1hc3MgZnJvbSBcIi4vTWFzc1wiO1xuaW1wb3J0IHsgYmV0d2VlbiwgZGlmZmVyZW5jZSB9IGZyb20gXCIuL3V0aWxpdGllc1wiO1xuXG5leHBvcnQgY29uc3QgR1JBVklUWV9YID0gMDsgLy8gcHgvZnJeMlxuZXhwb3J0IGNvbnN0IEdSQVZJVFlfWSA9IDE7IC8vIHB4L2ZyXjJcbmV4cG9ydCBjb25zdCBBSVJfUkVTSVNUQU5DRSA9IDAuMjU7IC8vIFRPRE9cbmV4cG9ydCBjb25zdCBGUklDVElPTiA9IDAuMjU7IC8vIFRPRE86IHRoaXMgc2hvdWxkIGJlIGRlcGVuZGVudCBvbiBtYXNzXG5leHBvcnQgY29uc3QgTk9STUFMX0RSQUcgPSAxMDA7IC8vIHN1cmZhY2UgYXJlYSBpbiBwaXhlbHMsIHBlciBraWxvZ3JhbVxuXG5pbnRlcmZhY2UgT3ZlcmxhcCB7XG4gIHRvcDogbnVtYmVyO1xuICBsZWZ0OiBudW1iZXI7XG4gIHJpZ2h0OiBudW1iZXI7XG4gIGJvdHRvbTogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgUG9pbnQge1xuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcbn1cblxuY2xhc3MgVW5pdmVyc2Uge1xuICBwdWJsaWMgbWFzc2VzID0gW10gYXMgTWFzc1tdO1xuXG4gIG92ZXJsYXBGb3JNb3ZlKHN1YmplY3Q6IE1hc3MsIHRvUG9zaXRpb246IFBvaW50KTogT3ZlcmxhcCB7XG4gICAgY29uc3QgbW92ZWRTdWJqZWN0ID0gbmV3IE1hc3Moe1xuICAgICAgLi4uc3ViamVjdCxcbiAgICAgIC4uLnRvUG9zaXRpb24sXG4gICAgICBkYXJrTWF0dGVyOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgY29uc3QgZHggPSBtb3ZlZFN1YmplY3QueCAtIHN1YmplY3QueDtcbiAgICBjb25zdCBkeSA9IG1vdmVkU3ViamVjdC55IC0gc3ViamVjdC55O1xuICAgIGNvbnN0IG1vdmluZyA9IHtcbiAgICAgIHVwOiBkeSA8IDAsXG4gICAgICBkb3duOiBkeSA+IDAsXG4gICAgICBsZWZ0OiBkeCA8IDAsXG4gICAgICByaWdodDogZHggPiAwLFxuICAgIH07XG5cbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqL1xuICAgIHJldHVybiB0aGlzLm1hc3Nlcy5yZWR1Y2UoKG92ZXJsYXAsIG9ic3RhY2xlKSA9PiB7XG4gICAgICBpZiAob2JzdGFjbGUgPT09IHN1YmplY3QpIHJldHVybiBvdmVybGFwO1xuXG4gICAgICBjb25zdCBoaXR0aW5nT2JzdGFjbGUgPSBtb3ZlZFN1YmplY3QuaXNIaXR0aW5nKG9ic3RhY2xlKTtcbiAgICAgIGlmICghaGl0dGluZ09ic3RhY2xlKSByZXR1cm4gb3ZlcmxhcDtcblxuICAgICAgaWYgKG1vdmluZy51cCAmJiBiZXR3ZWVuKG9ic3RhY2xlLmJvdHRvbSwgc3ViamVjdC50b3AsIG1vdmVkU3ViamVjdC50b3ApKSB7XG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gZGlmZmVyZW5jZShvYnN0YWNsZS5ib3R0b20sIG1vdmVkU3ViamVjdC50b3ApO1xuICAgICAgICBpZiAob3ZlcmxhcC50b3AgPCBkaXN0YW5jZSkgb3ZlcmxhcC50b3AgPSBkaXN0YW5jZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG1vdmluZy5kb3duICYmIGJldHdlZW4ob2JzdGFjbGUudG9wLCBzdWJqZWN0LmJvdHRvbSwgbW92ZWRTdWJqZWN0LmJvdHRvbSkpIHtcbiAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBkaWZmZXJlbmNlKG9ic3RhY2xlLnRvcCwgbW92ZWRTdWJqZWN0LmJvdHRvbSk7XG4gICAgICAgIGlmIChvdmVybGFwLmJvdHRvbSA8IGRpc3RhbmNlKSBvdmVybGFwLmJvdHRvbSA9IGRpc3RhbmNlO1xuICAgICAgfVxuXG4gICAgICBpZiAobW92aW5nLmxlZnQgJiYgYmV0d2VlbihvYnN0YWNsZS5yaWdodCwgc3ViamVjdC5sZWZ0LCBtb3ZlZFN1YmplY3QubGVmdCkpIHtcbiAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBkaWZmZXJlbmNlKG9ic3RhY2xlLnJpZ2h0LCBtb3ZlZFN1YmplY3QubGVmdCk7XG4gICAgICAgIGlmIChvdmVybGFwLmxlZnQgPCBkaXN0YW5jZSkgb3ZlcmxhcC5sZWZ0ID0gZGlzdGFuY2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb3ZpbmcucmlnaHQgJiYgYmV0d2VlbihvYnN0YWNsZS5sZWZ0LCBzdWJqZWN0LnJpZ2h0LCBtb3ZlZFN1YmplY3QucmlnaHQpKSB7XG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gZGlmZmVyZW5jZShvYnN0YWNsZS5sZWZ0LCBtb3ZlZFN1YmplY3QucmlnaHQpO1xuICAgICAgICBpZiAob3ZlcmxhcC5yaWdodCA8IGRpc3RhbmNlKSBvdmVybGFwLnJpZ2h0ID0gZGlzdGFuY2U7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvdmVybGFwO1xuICAgIH0sIHtcbiAgICAgIHRvcDogMCxcbiAgICAgIGJvdHRvbTogMCxcbiAgICAgIGxlZnQ6IDAsXG4gICAgICByaWdodDogMCxcbiAgICB9KTtcbiAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG4gIH1cblxuICBvdmVybGFwcGluZ01hc3NlcyhzdWJqZWN0OiBNYXNzLCB7IGlnbm9yZSA9IFtdIH06IHsgaWdub3JlPzogTWFzc1tdIH0gPSB7fSk6IE1hc3NbXSB7XG4gICAgcmV0dXJuIHRoaXMubWFzc2VzLmZpbHRlcigobWFzcykgPT4ge1xuICAgICAgaWYgKHN1YmplY3QgPT09IG1hc3MgfHwgaWdub3JlLmluY2x1ZGVzKG1hc3MpKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gc3ViamVjdC5pc0hpdHRpbmcobWFzcyk7XG4gICAgfSk7XG4gIH1cblxuICBvdmVybGFwKHN1YmplY3Q6IE1hc3MsIHsgaWdub3JlID0gW10gfTogeyBpZ25vcmU/OiBNYXNzW10gfSA9IHt9KTogT3ZlcmxhcCB7XG4gICAgY29uc3QgbWFzc2VzID0gdGhpcy5vdmVybGFwcGluZ01hc3NlcyhzdWJqZWN0LCB7IGlnbm9yZSB9KTtcbiAgICAvKipcbiAgICAgKiAsLS0tLSxcbiAgICAgKiB8ICAgIHwgPD0gc3ViamVjdFxuICAgICAqICctLS0tJ1xuICAgICAqIC4uLi4uLlxuICAgICAqIDogICAgOiA8PSBtYXNzXG4gICAgICogYGBgYGBgXG4gICAgICovXG4gICAgcmV0dXJuIG1hc3Nlcy5yZWR1Y2UoKG1lbW86IE92ZXJsYXAsIG1hc3MpID0+IHtcbiAgICAgIGNvbnN0IG92ZXJsYXAgPSBtZW1vO1xuXG4gICAgICAvKipcbiAgICAgICAqICwtLS0tLCAgICAsLS0tLSwgICAgLC0uLS0sLi4gICAgLC0tLS0sICAgICwtLS0tLCAgLi4sLS0uLSwgICAgLC0tLS0sICAgICAgLC0tLS0sICAgIC4uLC0tLS0sLi5cbiAgICAgICAqIHwgICAgfCAgICB8IC4uLnwuLiAgfCA6ICB8IDogICAgfCAgICB8ICAuLnwuLi4gfCAgOiB8ICA6IHwgICAgfCAgICB8ICAgIC4ufC4uLi58Li4gIDogfCAgICB8IDpcbiAgICAgICAqICctLi0tJy4uICAnLTotLScgOiAgJy0tLS0nYGAgIC4uJy0tLi0nICA6ICctLTotJyAgYGAnLS0tLScgIC4uJy0tLS0nLi4gIDogJy0tLS0nIDogIGBgJy0tLS0nYGBcbiAgICAgICAqICAgOiAgICA6ICAgIGBgYGBgYCAgICAgICAgICAgIDogICAgOiAgICBgYGBgYGAgICAgICAgICAgICAgIDogICAgICAgIDogIGBgYGBgYGBgYGBcbiAgICAgICAqICAgYGBgYGBgICAgICAgICAgICAgICAgICAgICAgIGBgYGBgYCAgICAgICAgICAgICAgICAgICAgICAgIGBgYGBgYGBgYGBcbiAgICAgICAqL1xuICAgICAgY29uc3QgbWFzc1RvcE92ZXJsYXAgPSBtYXNzLnRvcCA+PSBzdWJqZWN0LnRvcCAmJiBtYXNzLnRvcCA8PSBzdWJqZWN0LmJvdHRvbTtcbiAgICAgIGlmIChtYXNzVG9wT3ZlcmxhcCkge1xuICAgICAgICBjb25zdCBkaXN0YW5jZSA9IHN1YmplY3QuYm90dG9tIC0gbWFzcy50b3A7XG4gICAgICAgIGlmIChvdmVybGFwLmJvdHRvbSA8IGRpc3RhbmNlKSBvdmVybGFwLmJvdHRvbSA9IGRpc3RhbmNlO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIC4uLi4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uLi4uICAgICAgICAgICAgICAgICAgICAgLi4uLi4uLi4uLlxuICAgICAgICogOiAgICA6ICAgIC4uLi4uLiAgICAgICAgICAgICAgICA6ICAgIDogICAuLi4uLi4gICAgICAgICAgICA6ICAgICAgICA6ICAuLi4uLi4uLi4uXG4gICAgICAgKiBgYCwtLS0tLCAgOiAsLS06LSwgIC4uLC0tLS0sICAsLWAtLSxgYCAsLTotLSwgOiAgLC0tLS0sLi4gIGBgLC0tLS0sYGAgIDogLC0tLS0sIDogIC4uLC0tLS0sLi5cbiAgICAgICAqICAgfCAgICB8ICBgYHxgYGAgfCAgOiB8ICA6IHwgIHwgICAgfCAgIHwgYGBgfGBgICB8IDogIHwgOiAgICB8ICAgIHwgICAgYGB8YGBgYHxgYCAgOiB8ICAgIHwgOlxuICAgICAgICogICAnLS0tLScgICAgJy0tLS0nICBgYCctLWAtJyAgJy0tLS0nICAgJy0tLS0nICAgICctYC0tJ2BgICAgICctLS0tJyAgICAgICctLS0tJyAgICBgYCctLS0tJ2BgXG4gICAgICAgKi9cbiAgICAgIGNvbnN0IG1hc3NCb3R0b21PdmVybGFwID0gbWFzcy5ib3R0b20gPD0gc3ViamVjdC5ib3R0b20gJiYgbWFzcy5ib3R0b20gPj0gc3ViamVjdC50b3A7XG4gICAgICBpZiAobWFzc0JvdHRvbU92ZXJsYXApIHtcbiAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBtYXNzLmJvdHRvbSAtIHN1YmplY3QudG9wO1xuICAgICAgICBpZiAob3ZlcmxhcC50b3AgPCBkaXN0YW5jZSkgb3ZlcmxhcC50b3AgPSBkaXN0YW5jZTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiAgICAgIC4uLi4uLlxuICAgICAgICogLC0tLS06ICAgIDpcbiAgICAgICAqIHwgICAgfGBgYGBgXG4gICAgICAgKiAnLS0tLSdcbiAgICAgICAqICAgLi4uLi4uXG4gICAgICAgKiAuLTotLS4gOlxuICAgICAgICogfCBgYGB8YGBcbiAgICAgICAqICctLS0tJ1xuICAgICAgICogLi4uLi4uXG4gICAgICAgKiA6LS0tLTpcbiAgICAgICAqIHxgYGBgfFxuICAgICAgICogJy0tLS0nXG4gICAgICAgKiAsLS0tLSxcbiAgICAgICAqIHwgICAgfC4uLi4uXG4gICAgICAgKiAnLS0tLTogICAgOlxuICAgICAgICogICAgICBgYGBgYGBcbiAgICAgICAqICwtLS0tLFxuICAgICAgICogfCAuLi58Li5cbiAgICAgICAqICctOi0tJyA6XG4gICAgICAgKiAgIGBgYGBgYFxuICAgICAgICogLC0tLS0sXG4gICAgICAgKiB8Li4uLnxcbiAgICAgICAqIDotLS0tOlxuICAgICAgICogYGBgYGBgXG4gICAgICAgKiAgICAgIC4uLi4uLlxuICAgICAgICogLC0tLS06ICAgIDpcbiAgICAgICAqIHwgICAgfCAgICA6XG4gICAgICAgKiAnLS0tLTogICAgOlxuICAgICAgICogICAgICBgYGBgYGBcbiAgICAgICAqICAgLi4uLi4uXG4gICAgICAgKiAsLTotLSwgOlxuICAgICAgICogfCA6ICB8IDpcbiAgICAgICAqICctOi0tJyA6XG4gICAgICAgKiAgIGBgYGBgYFxuICAgICAgICogLi4uLi4uXG4gICAgICAgKiA6LS0tLTpcbiAgICAgICAqIHwgICAgfFxuICAgICAgICogOi0tLS06XG4gICAgICAgKiBgYGBgYGBcbiAgICAgICAqL1xuICAgICAgY29uc3QgbWFzc0xlZnRPdmVybGFwID0gbWFzcy5sZWZ0ID49IHN1YmplY3QubGVmdCAmJiBtYXNzLmxlZnQgPD0gc3ViamVjdC5yaWdodDtcbiAgICAgIGlmIChtYXNzTGVmdE92ZXJsYXApIHtcbiAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBzdWJqZWN0LnJpZ2h0IC0gbWFzcy5sZWZ0O1xuICAgICAgICBpZiAob3ZlcmxhcC5yaWdodCA8IGRpc3RhbmNlKSBvdmVybGFwLnJpZ2h0ID0gZGlzdGFuY2U7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogLi4uLi4uXG4gICAgICAgKiA6ICAgIDotLS0tLFxuICAgICAgICogYGBgYGB8ICAgIHxcbiAgICAgICAqICAgICAgJy0tLS0nXG4gICAgICAgKiAgICAuLi4uLi5cbiAgICAgICAqICAgIDogLC0tOi0sXG4gICAgICAgKiAgICBgYHxgYGAgfFxuICAgICAgICogICAgICAnLS0tLSdcbiAgICAgICAqICAgICAgLi4uLi4uXG4gICAgICAgKiAgICAgIDotLS0tOlxuICAgICAgICogICAgICB8YGBgYHxcbiAgICAgICAqICAgICAgJy0tLS0nXG4gICAgICAgKiAgICAgICwtLS0tLFxuICAgICAgICogLi4uLi58ICAgIHxcbiAgICAgICAqIDogICAgOi0tLS0nXG4gICAgICAgKiBgYGBgYGBcbiAgICAgICAqICAgICAgLC0tLS0sXG4gICAgICAgKiAgICAuLnwuLi4gfFxuICAgICAgICogICAgOiAnLS06LSdcbiAgICAgICAqICAgIGBgYGBgYFxuICAgICAgICogICAgICAsLS0tLSxcbiAgICAgICAqICAgICAgfC4uLi58XG4gICAgICAgKiAgICAgIDotLS0tOlxuICAgICAgICogICAgICBgYGBgYGBcbiAgICAgICAqICAuLi4uLi5cbiAgICAgICAqICA6ICAgICwtLS0tLFxuICAgICAgICogIDogICAgfCAgICB8XG4gICAgICAgKiAgOiAgICAnLS0tLSdcbiAgICAgICAqICBgYGBgYGBcbiAgICAgICAqICAgIC4uLi4uLlxuICAgICAgICogICAgOiAsLS06LSxcbiAgICAgICAqICAgIDogfCAgOiB8XG4gICAgICAgKiAgICA6ICctLTotJ1xuICAgICAgICogICAgYGBgYGBgXG4gICAgICAgKiAgICAgIC4uLi4uLlxuICAgICAgICogICAgICA6LS0tLTpcbiAgICAgICAqICAgICAgfCAgICB8XG4gICAgICAgKiAgICAgIDotLS0tOlxuICAgICAgICogICAgICBgYGBgYGBcbiAgICAgICAqL1xuICAgICAgY29uc3QgbWFzc1JpZ2h0T3ZlcmxhcCA9IG1hc3MucmlnaHQgPj0gc3ViamVjdC5sZWZ0ICYmIG1hc3MucmlnaHQgPD0gc3ViamVjdC5yaWdodDtcbiAgICAgIGlmIChtYXNzUmlnaHRPdmVybGFwKSB7XG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gbWFzcy5yaWdodCAtIHN1YmplY3QubGVmdDtcbiAgICAgICAgaWYgKG92ZXJsYXAubGVmdCA8IGRpc3RhbmNlKSBvdmVybGFwLmxlZnQgPSBkaXN0YW5jZTtcbiAgICAgIH1cblxuICAgICAgLy8gSSdtIG1pc3NpbmcgdG90YWwgb3ZlcmxhcHMgYW5kIHRvdGFsIGVjbGlwc2VzIGJ1dCBJIGRvbid0IGdpdmUgYSBzaGl0XG4gICAgICByZXR1cm4gb3ZlcmxhcDtcbiAgICB9LCB7XG4gICAgICB0b3A6IDAsXG4gICAgICByaWdodDogMCxcbiAgICAgIGJvdHRvbTogMCxcbiAgICAgIGxlZnQ6IDAsXG4gICAgfSk7XG4gIH1cbn1cblxuY29uc3QgdW5pdmVyc2UgPSBuZXcgVW5pdmVyc2UoKTtcbmV4cG9ydCBkZWZhdWx0IHVuaXZlcnNlO1xuIiwiaW1wb3J0IHVuaXZlcnNlLCB7IEdSQVZJVFlfWCwgR1JBVklUWV9ZLCBGUklDVElPTiwgTk9STUFMX0RSQUcgfSBmcm9tIFwiLi91bml2ZXJzZVwiO1xuaW1wb3J0IHsgZGFtcGVuLCBib3VuZCB9IGZyb20gXCIuL3V0aWxpdGllc1wiO1xuXG5jb25zdCB1cGRhdGVEaW1lbnNpb24gPSAoXG4gIHBvc2l0aW9uOiBudW1iZXIsXG4gIHZlbG9jaXR5OiBudW1iZXIsXG4gIGFjY2VsZXJhdGlvbjogbnVtYmVyLFxuICBtaW46IG51bWJlcixcbiAgbWF4OiBudW1iZXIsXG4pOiB7IHBvc2l0aW9uOiBudW1iZXI7IHZlbG9jaXR5OiBudW1iZXIgfSA9PiB7XG4gIGxldCBuZXdQb3NpdGlvbiA9IHBvc2l0aW9uICsgdmVsb2NpdHk7XG4gIGxldCBuZXdWZWxvY2l0eSA9IHZlbG9jaXR5ICsgYWNjZWxlcmF0aW9uO1xuICBpZiAobmV3UG9zaXRpb24gPiBtYXgpIHtcbiAgICBuZXdQb3NpdGlvbiA9IG1heDtcbiAgICBuZXdWZWxvY2l0eSA9IDA7XG4gIH0gZWxzZSBpZiAobmV3UG9zaXRpb24gPCBtaW4pIHtcbiAgICBuZXdQb3NpdGlvbiA9IG1pbjtcbiAgICBuZXdWZWxvY2l0eSA9IDA7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHBvc2l0aW9uOiBuZXdQb3NpdGlvbixcbiAgICB2ZWxvY2l0eTogbmV3VmVsb2NpdHksXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYXNzIHtcbiAgcHVibGljIG1hc3MgPSAxOyAvLyBrZ1xuICBwdWJsaWMgeCA9IDA7IC8vIHB4XG4gIHB1YmxpYyB5ID0gMDsgLy8gcHhcbiAgcHVibGljIGR4ID0gMDsgLy8gcHgvZnJcbiAgcHVibGljIGR5ID0gMDsgLy8gcHgvZnJcbiAgcHVibGljIHdpZHRoID0gMjU7IC8vIHB4XG4gIHB1YmxpYyBoZWlnaHQgPSAyNTsgLy8gcHhcbiAgcHVibGljIHN0YXRpb25hcnkgPSBmYWxzZTtcbiAgcHVibGljIGRhcmtNYXR0ZXIgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zPzogUGFydGlhbDxNYXNzPikge1xuICAgIE9iamVjdC5hc3NpZ24odGhpcywgb3B0aW9ucyk7XG4gICAgaWYgKCF0aGlzLmRhcmtNYXR0ZXIpIHVuaXZlcnNlLm1hc3Nlcy5wdXNoKHRoaXMpO1xuICB9XG5cbiAgZ2V0IGRyYWdDb2VmZmljaWVudCgpOiBudW1iZXIge1xuICAgIGNvbnN0IHN1cmZhY2VBcmVhID0gKDIgKiB0aGlzLndpZHRoKSArICgyICogdGhpcy5oZWlnaHQpO1xuICAgIHJldHVybiAoc3VyZmFjZUFyZWEgLyB0aGlzLm1hc3MpIC8gTk9STUFMX0RSQUc7XG4gIH1cblxuICBnZXQgYXgoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMuc3RhdGlvbmFyeSA/IDAgOiBHUkFWSVRZX1g7IH1cbiAgZ2V0IGF5KCk6IG51bWJlciB7IHJldHVybiB0aGlzLnN0YXRpb25hcnkgPyAwIDogR1JBVklUWV9ZOyB9XG5cbiAgZ2V0IGlzQWdhaW5zdFRvcFdhbGwoKTogYm9vbGVhbiB7IHJldHVybiB0aGlzLnkgPT09IDA7IH1cbiAgZ2V0IGlzQWdhaW5zdEJvdHRvbVdhbGwoKTogYm9vbGVhbiB7IHJldHVybiB0aGlzLnkgPT09IHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuaGVpZ2h0OyB9XG4gIGdldCBpc0FnYWluc3RMZWZ0V2FsbCgpOiBib29sZWFuIHsgcmV0dXJuIHRoaXMueCA9PT0gMDsgfVxuICBnZXQgaXNBZ2FpbnN0UmlnaHRXYWxsKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy54ID09PSB3aW5kb3cuaW5uZXJXaWR0aCAtIHRoaXMud2lkdGg7IH1cblxuICBnZXQgdGVybWluYWxWZWxvY2l0eSgpOiBudW1iZXIge1xuICAgIHJldHVybiAyMDsgLy8gVE9ETzogc2hvdWxkIGJlIGJhc2VkIG9uIGRyYWdcbiAgfVxuXG4gIGdldCB0b3AoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMueTsgfVxuICBnZXQgcmlnaHQoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGg7IH1cbiAgZ2V0IGJvdHRvbSgpOiBudW1iZXIgeyByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQ7IH1cbiAgZ2V0IGxlZnQoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMueDsgfVxuXG4gIHVwZGF0ZSgpOiB2b2lkIHtcbiAgICBjb25zdCBuZXdYRGF0YSA9IHVwZGF0ZURpbWVuc2lvbih0aGlzLngsIHRoaXMuZHgsIHRoaXMuYXgsIHRoaXMud2lkdGgsIHdpbmRvdy5pbm5lcldpZHRoIC0gdGhpcy53aWR0aCk7XG4gICAgY29uc3QgbmV3WURhdGEgPSB1cGRhdGVEaW1lbnNpb24odGhpcy55LCB0aGlzLmR5LCB0aGlzLmF5LCB0aGlzLmhlaWdodCwgd2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5oZWlnaHQpO1xuXG4gICAgbGV0IG5ld1ggPSBuZXdYRGF0YS5wb3NpdGlvbjtcbiAgICBsZXQgbmV3WSA9IG5ld1lEYXRhLnBvc2l0aW9uO1xuICAgIGxldCBuZXdEeCA9IG5ld1hEYXRhLnZlbG9jaXR5O1xuICAgIGxldCBuZXdEeSA9IG5ld1lEYXRhLnZlbG9jaXR5O1xuXG4gICAgY29uc3Qgb3ZlcmxhcCA9IHVuaXZlcnNlLm92ZXJsYXBGb3JNb3ZlKHRoaXMsIHsgeDogbmV3WCwgeTogbmV3WSB9KTtcblxuICAgIGlmIChvdmVybGFwLnJpZ2h0ID4gMCkge1xuICAgICAgbmV3WCAtPSBvdmVybGFwLnJpZ2h0O1xuICAgICAgbmV3RHggPSAwO1xuICAgIH0gZWxzZSBpZiAob3ZlcmxhcC5sZWZ0ID4gMCkge1xuICAgICAgbmV3WCArPSBvdmVybGFwLmxlZnQ7XG4gICAgICBuZXdEeCA9IDA7XG4gICAgfVxuXG4gICAgaWYgKG92ZXJsYXAuYm90dG9tID4gMCkge1xuICAgICAgbmV3WSAtPSBvdmVybGFwLmJvdHRvbTtcbiAgICAgIG5ld0R5ID0gMDtcbiAgICB9IGVsc2UgaWYgKG92ZXJsYXAudG9wID4gMCkge1xuICAgICAgbmV3WSArPSBvdmVybGFwLnRvcDtcbiAgICAgIG5ld0R5ID0gMDtcbiAgICB9XG5cbiAgICB0aGlzLnggPSBuZXdYO1xuICAgIHRoaXMueSA9IG5ld1k7XG5cbiAgICBpZiAodGhpcy5pc0FnYWluc3RUb3BXYWxsIHx8IHRoaXMuaXNBZ2FpbnN0Qm90dG9tV2FsbCB8fCBvdmVybGFwLnRvcCB8fCBvdmVybGFwLmJvdHRvbSkge1xuICAgICAgbmV3RHggPSBkYW1wZW4obmV3RHgsIEZSSUNUSU9OKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNBZ2FpbnN0TGVmdFdhbGwgfHwgdGhpcy5pc0FnYWluc3RSaWdodFdhbGwgfHwgb3ZlcmxhcC5sZWZ0IHx8IG92ZXJsYXAucmlnaHQpIHtcbiAgICAgIG5ld0R5ID0gZGFtcGVuKG5ld0R5LCBGUklDVElPTik7XG4gICAgfVxuXG4gICAgdGhpcy5keCA9IGJvdW5kKG5ld0R4LCAtMSAqIHRoaXMudGVybWluYWxWZWxvY2l0eSwgdGhpcy50ZXJtaW5hbFZlbG9jaXR5KTtcbiAgICB0aGlzLmR5ID0gYm91bmQobmV3RHksIC0xICogdGhpcy50ZXJtaW5hbFZlbG9jaXR5LCB0aGlzLnRlcm1pbmFsVmVsb2NpdHkpO1xuICB9XG5cbiAgaXNIaXR0aW5nKG1hc3M6IE1hc3MpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5yaWdodCA+PSBtYXNzLmxlZnRcbiAgICAgICYmIHRoaXMubGVmdCA8PSBtYXNzLnJpZ2h0XG4gICAgICAmJiB0aGlzLmJvdHRvbSA+PSBtYXNzLnRvcFxuICAgICAgJiYgdGhpcy50b3AgPD0gbWFzcy5ib3R0b21cbiAgICApO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgTW91c2Uge1xuICBwdWJsaWMgeCA9IDA7XG4gIHB1YmxpYyB5ID0gMDtcbiAgcHVibGljIHByZXNzZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLnBvcHVsYXRlRnJvbU1vdXNlRXZlbnQoZXZlbnQpO1xuICAgIH0pO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMucG9wdWxhdGVGcm9tTW91c2VFdmVudChldmVudCk7XG4gICAgfSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMucG9wdWxhdGVGcm9tTW91c2VFdmVudChldmVudCk7XG4gICAgfSk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5wb3B1bGF0ZUZyb21Ub3VjaEV2ZW50KGV2ZW50KTtcbiAgICB9KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLnBvcHVsYXRlRnJvbVRvdWNoRXZlbnQoZXZlbnQpO1xuICAgIH0pO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5wb3B1bGF0ZUZyb21Ub3VjaEV2ZW50KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIHBvcHVsYXRlRnJvbU1vdXNlRXZlbnQoZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLnggPSBldmVudC54O1xuICAgIHRoaXMueSA9IGV2ZW50Lnk7XG4gICAgdGhpcy5wcmVzc2VkID0gZXZlbnQuYnV0dG9ucyA9PT0gMTtcbiAgfVxuXG4gIHBvcHVsYXRlRnJvbVRvdWNoRXZlbnQoZXZlbnQ6IFRvdWNoRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCB7IHRvdWNoZXMgfSA9IGV2ZW50O1xuICAgIGlmICh0b3VjaGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5wcmVzc2VkID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHRvdWNoID0gdG91Y2hlc1swXTtcbiAgICAgIHRoaXMueCA9IHRvdWNoLmNsaWVudFg7XG4gICAgICB0aGlzLnkgPSB0b3VjaC5jbGllbnRZO1xuICAgICAgdGhpcy5wcmVzc2VkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgbW91c2UgPSBuZXcgTW91c2UoKTtcblxuZXhwb3J0IGRlZmF1bHQgbW91c2U7XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuXG5pbXBvcnQgeyBjdHggfSBmcm9tICcuL2NhbnZhcyc7XG5pbXBvcnQgZ2FtZUxvb3AgZnJvbSAnLi9nYW1lTG9vcCc7XG5pbXBvcnQgTWFzcyBmcm9tICcuL01hc3MnO1xuaW1wb3J0IFBsYXllciBmcm9tICcuL1BsYXllcic7XG5pbXBvcnQgeyByYW5nZSwgcmFuZCB9IGZyb20gJy4vdXRpbGl0aWVzJztcbmltcG9ydCB1bml2ZXJzZSBmcm9tICcuL3VuaXZlcnNlJztcblxuY29uc3QgcGxheWVyID0gbmV3IFBsYXllcigpO1xuXG5jb25zdCBtYXNzZXMgPSByYW5nZSgxMCkubWFwKCgpID0+IHtcbiAgcmV0dXJuIG5ldyBNYXNzKHtcbiAgICBtYXNzOiByYW5kKDAuNSwgNSksXG4gICAgeDogcmFuZCgwLCB3aW5kb3cuaW5uZXJXaWR0aCksXG4gICAgeTogcmFuZCgwLCB3aW5kb3cuaW5uZXJIZWlnaHQpLFxuICAgIHdpZHRoOiByYW5kKDUwLCAxNTApLFxuICAgIGhlaWdodDogcmFuZCg1MCwgMTUwKSxcbiAgICBzdGF0aW9uYXJ5OiB0cnVlLFxuICB9KTtcbn0pO1xuXG5jb25zdCBzdGFycyA9IHJhbmdlKDEwMCkubWFwKCgpID0+IHtcbiAgY29uc3Qgc2l6ZSA9IHJhbmQoMSwgNSk7XG4gIHJldHVybiBbXG4gICAgcmFuZCgwLCB3aW5kb3cuaW5uZXJXaWR0aCksXG4gICAgcmFuZCgwLCB3aW5kb3cuaW5uZXJIZWlnaHQpLFxuICAgIHNpemUsXG4gICAgc2l6ZSxcbiAgXSBhcyBjb25zdDtcbn0pO1xuXG5nYW1lTG9vcChjdHgsICgpID0+IHtcbiAgc3RhcnMuZm9yRWFjaCgocmVjdE9wdGlvbnMsIGluZGV4KSA9PiB7XG4gICAgY29uc3Qgb3BhY2l0eSA9ICgoaW5kZXggJSAxMCkgKyAxKSAvIDEwO1xuICAgIGN0eC5maWxsU3R5bGUgPSBgcmdiYSgyNTUsIDI1NSwgMjU1LCAke29wYWNpdHl9KWA7XG4gICAgY3R4LmZpbGxSZWN0KC4uLnJlY3RPcHRpb25zKTtcbiAgfSk7XG5cbiAgbWFzc2VzLmZvckVhY2goKG1hc3MpID0+IHtcbiAgICBpZiAocGxheWVyLmlzSGl0dGluZyhtYXNzKSkge1xuICAgICAgY3R4LmZpbGxTdHlsZSA9ICdyZ2JhKDI1NSwgMCwgMCwgMC4yKSc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN0eC5maWxsU3R5bGUgPSAncmdiYSgyNTUsIDAsIDAsIDAuNSknO1xuICAgIH1cblxuICAgIGN0eC5maWxsUmVjdChtYXNzLngsIG1hc3MueSwgbWFzcy53aWR0aCwgbWFzcy5oZWlnaHQpO1xuICB9KTtcblxuICBjdHguZmlsbFN0eWxlID0gJ3JnYmEoMCwgMTUwLCAwLCAxKSc7XG4gIGN0eC5maWxsUmVjdChwbGF5ZXIueCwgcGxheWVyLnksIHBsYXllci53aWR0aCwgcGxheWVyLmhlaWdodCk7XG5cbiAgY29uc3QgZmFjZW1hc2tDb2xvciA9ICdyZ2JhKDIyMCwgMjIwLCAyNTUsIDEpJztcbiAgY29uc3QgZmFjZW1hc2tXaWR0aCA9IHBsYXllci53aWR0aCAvIDI7XG4gIGNvbnN0IGZhY2VtYXNrSGVpZ2h0ID0gcGxheWVyLmhlaWdodCAvIDU7XG4gIGNvbnN0IGZhY2VtYXNrT2Zmc2V0WSA9IDM7XG4gIGN0eC5maWxsU3R5bGUgPSBmYWNlbWFza0NvbG9yO1xuICBzd2l0Y2ggKHBsYXllci5idXJuZXJYU2lkZSkge1xuICAgIGNhc2UgJ2xlZnQnOiBjdHguZmlsbFJlY3QocGxheWVyLnggKyAocGxheWVyLndpZHRoIC0gZmFjZW1hc2tXaWR0aCksIHBsYXllci55ICsgZmFjZW1hc2tPZmZzZXRZLCBmYWNlbWFza1dpZHRoLCBmYWNlbWFza0hlaWdodCk7IGJyZWFrO1xuICAgIGNhc2UgJ3JpZ2h0JzogY3R4LmZpbGxSZWN0KHBsYXllci54LCBwbGF5ZXIueSArIGZhY2VtYXNrT2Zmc2V0WSwgZmFjZW1hc2tXaWR0aCwgZmFjZW1hc2tIZWlnaHQpOyBicmVhaztcbiAgICBkZWZhdWx0OiBjdHguZmlsbFJlY3QocGxheWVyLnggKyAoKHBsYXllci53aWR0aCAtIGZhY2VtYXNrV2lkdGgpIC8gMiksIHBsYXllci55ICsgZmFjZW1hc2tPZmZzZXRZLCBmYWNlbWFza1dpZHRoLCBmYWNlbWFza0hlaWdodCk7IGJyZWFrO1xuICB9XG5cbiAgY29uc3QgYnVybmVyQ29sb3IgPSBgcmdiYSgyNTUsIDEwMCwgMCwgJHtyYW5kKDAuNSwgMC43NSl9KWA7XG4gIGNvbnN0IGJ1cm5lckxlbmd0aFggPSByYW5kKDAuMjUsIDAuNCkgKiBwbGF5ZXIud2lkdGg7XG4gIGNvbnN0IGJ1cm5lckxlbmd0aFkgPSByYW5kKDAuNCwgMC42KSAqIHBsYXllci5oZWlnaHQ7XG4gIGNvbnN0IGJ1cm5lckFjcm9zcyA9ICh3aWR0aDogbnVtYmVyKTogbnVtYmVyID0+IDAuNiAqIHdpZHRoO1xuICBjb25zdCBidXJuZXJBY3Jvc3NPZmZzZXQgPSAod2lkdGg6IG51bWJlcik6IG51bWJlciA9PiAod2lkdGggLSBidXJuZXJBY3Jvc3Mod2lkdGgpKSAvIDI7XG5cbiAgY3R4LmZpbGxTdHlsZSA9IGJ1cm5lckNvbG9yO1xuICBzd2l0Y2ggKHBsYXllci5idXJuZXJYU2lkZSkge1xuICAgIGNhc2UgJ2xlZnQnOiBjdHguZmlsbFJlY3QoXG4gICAgICBwbGF5ZXIueCAtIGJ1cm5lckxlbmd0aFgsIC8vIHBvc2l0aW9uZWQgb24gdGhlIGxlZnQgc2lkZSBvZiB0aGUgcGxheWVyXG4gICAgICBwbGF5ZXIueSArIGJ1cm5lckFjcm9zc09mZnNldChwbGF5ZXIuaGVpZ2h0KSwgLy8gY2VudGVyZWQgb24gdGhlIFkgYXhpc1xuICAgICAgYnVybmVyTGVuZ3RoWCwgLy8gbG9uZyB0YWlsIG9yaWVudGVkIGFsb25nIHRoZSBYIGF4aXNcbiAgICAgIGJ1cm5lckFjcm9zcyhwbGF5ZXIuaGVpZ2h0KSwgLy8gY3Jvc3Mtc2VjdGlvbiBvcmllbnRlZCBhbG9uZyB0aGUgWSBheGlzXG4gICAgKTsgYnJlYWs7XG4gICAgY2FzZSAncmlnaHQnOiBjdHguZmlsbFJlY3QoXG4gICAgICBwbGF5ZXIueCArIHBsYXllci53aWR0aCwgLy8gcG9zaXRpb25lZCBvbiB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgcGxheWVyXG4gICAgICBwbGF5ZXIueSArIGJ1cm5lckFjcm9zc09mZnNldChwbGF5ZXIuaGVpZ2h0KSwgLy8gY2VudGVyZWQgb24gdGhlIFkgYXhpc1xuICAgICAgYnVybmVyTGVuZ3RoWCwgLy8gbG9uZyB0YWlsIG9yaWVudGVkIGFsb25nIHRoZSBYIGF4aXNcbiAgICAgIGJ1cm5lckFjcm9zcyhwbGF5ZXIuaGVpZ2h0KSwgLy8gY3Jvc3Mtc2VjdGlvbiBvcmllbnRlZCBhbG9uZyB0aGUgWSBheGlzXG4gICAgKTsgYnJlYWs7XG4gICAgZGVmYXVsdDogYnJlYWs7XG4gIH1cbiAgc3dpdGNoIChwbGF5ZXIuYnVybmVyWVNpZGUpIHtcbiAgICBjYXNlICdib3R0b20nOiBjdHguZmlsbFJlY3QoXG4gICAgICBwbGF5ZXIueCArIGJ1cm5lckFjcm9zc09mZnNldChwbGF5ZXIud2lkdGgpLCAvLyBjZW50ZXJlZCBvbiB0aGUgWCBheGlzXG4gICAgICBwbGF5ZXIueSArIHBsYXllci5oZWlnaHQsIC8vIHBvc2l0aW9uZWQgb24gdGhlIGJvdHRvbSBvZiB0aGUgcGxheWVyXG4gICAgICBidXJuZXJBY3Jvc3MocGxheWVyLndpZHRoKSwgLy8gY3Jvc3Mtc2VjdGlvbiBvcmllbnRlZCBhbG9uZyB0aGUgWCBheGlzXG4gICAgICBidXJuZXJMZW5ndGhZLCAvLyBsb25nIHRhaWwgb3JpZW50ZWQgYWxvbmcgdGhlIFkgYXhpc1xuICAgICk7IGJyZWFrO1xuICAgIGNhc2UgJ3RvcCc6IGN0eC5maWxsUmVjdChcbiAgICAgIHBsYXllci54ICsgYnVybmVyQWNyb3NzT2Zmc2V0KHBsYXllci53aWR0aCksIC8vIGNlbnRlcmVkIG9uIHRoZSBYIGF4aXNcbiAgICAgIHBsYXllci55IC0gYnVybmVyTGVuZ3RoWSwgLy8gcG9zaXRpb25lZCBvbiB0aGUgdG9wIG9mIHRoZSBwbGF5ZXJcbiAgICAgIGJ1cm5lckFjcm9zcyhwbGF5ZXIud2lkdGgpLCAvLyBjcm9zcy1zZWN0aW9uIG9yaWVudGVkIGFsb25nIHRoZSBYIGF4aXNcbiAgICAgIGJ1cm5lckxlbmd0aFksIC8vIGxvbmcgdGFpbCBvcmllbnRlZCBhbG9uZyB0aGUgWSBheGlzXG4gICAgKTsgYnJlYWs7XG4gICAgZGVmYXVsdDogYnJlYWs7XG4gIH1cblxuICBwbGF5ZXIudXBkYXRlKCk7XG59KTtcbiIsImltcG9ydCBNYXNzIGZyb20gXCIuL01hc3NcIjtcbmltcG9ydCBtb3VzZSBmcm9tIFwiLi9tb3VzZVwiO1xuaW1wb3J0IHsgYmV0d2VlbiB9IGZyb20gXCIuL3V0aWxpdGllc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQbGF5ZXIgZXh0ZW5kcyBNYXNzIHtcbiAgcHVibGljIHdpZHRoID0gMTU7XG4gIHB1YmxpYyBoZWlnaHQgPSAyMDtcbiAgcHVibGljIGpldHBhY2tGb3JjZVggPSAwLjQ7IC8vIChrZyAqIHB4KSAvIGZyXjJcbiAgcHVibGljIGpldHBhY2tGb3JjZVkgPSAxLjM7IC8vIChrZyAqIHB4KSAvIGZyXjJcblxuICBnZXQgYnVybmluZygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gbW91c2UucHJlc3NlZDtcbiAgfVxuXG4gIGdldCBheEpldHBhY2soKTogbnVtYmVyIHtcbiAgICBpZiAoIXRoaXMuYnVybmluZykgcmV0dXJuIDA7XG5cbiAgICBjb25zdCBtb3VzZURpc3RhbmNlID0gbW91c2UueCAtIHRoaXMueDtcbiAgICBjb25zdCBsZWZ0TWFyZ2luID0gLTEgKiB0aGlzLndpZHRoO1xuICAgIGNvbnN0IHJpZ2h0TWFyZ2luID0gMiAqIHRoaXMud2lkdGg7XG4gICAgaWYgKGJldHdlZW4obW91c2VEaXN0YW5jZSwgbGVmdE1hcmdpbiwgcmlnaHRNYXJnaW4pKSByZXR1cm4gMDtcblxuICAgIGNvbnN0IGpldHBhY2tBY2NlbGVyYXRpb24gPSB0aGlzLmpldHBhY2tGb3JjZVggLyB0aGlzLm1hc3M7XG4gICAgcmV0dXJuIG1vdXNlRGlzdGFuY2UgPiAwID8gamV0cGFja0FjY2VsZXJhdGlvbiA6IC0xICogamV0cGFja0FjY2VsZXJhdGlvbjtcbiAgfVxuXG4gIGdldCBheUpldHBhY2soKTogbnVtYmVyIHtcbiAgICBpZiAoIXRoaXMuYnVybmluZykgcmV0dXJuIDA7XG5cbiAgICBjb25zdCBtb3VzZURpc3RhbmNlID0gbW91c2UueSAtIHRoaXMueTtcbiAgICBjb25zdCB0b3BNYXJnaW4gPSAwO1xuICAgIGNvbnN0IGJvdHRvbU1hcmdpbiA9IHRoaXMuaGVpZ2h0O1xuICAgIGlmIChtb3VzZURpc3RhbmNlID49IDAgfHwgYmV0d2Vlbihtb3VzZURpc3RhbmNlLCB0b3BNYXJnaW4sIGJvdHRvbU1hcmdpbikpIHJldHVybiAwO1xuXG4gICAgY29uc3QgamV0cGFja0FjY2VsZXJhdGlvbiA9IHRoaXMuamV0cGFja0ZvcmNlWSAvIHRoaXMubWFzcztcbiAgICByZXR1cm4gLTEgKiBqZXRwYWNrQWNjZWxlcmF0aW9uO1xuICB9XG5cbiAgZ2V0IGF4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHN1cGVyLmF4ICsgdGhpcy5heEpldHBhY2s7XG4gIH1cblxuICBnZXQgYXkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gc3VwZXIuYXkgKyB0aGlzLmF5SmV0cGFjaztcbiAgfVxuXG4gIGdldCBidXJuZXJYU2lkZSgpOiAnbGVmdCd8J25vbmUnfCdyaWdodCcge1xuICAgIGlmICh0aGlzLmF4SmV0cGFjayA9PT0gMCkgcmV0dXJuICdub25lJztcbiAgICByZXR1cm4gdGhpcy5heEpldHBhY2sgPiAwID8gJ2xlZnQnIDogJ3JpZ2h0JztcbiAgfVxuXG4gIGdldCBidXJuZXJZU2lkZSgpOiAnYm90dG9tJ3wnbm9uZSd8J3RvcCcge1xuICAgIGlmICh0aGlzLmF5SmV0cGFjayA9PT0gMCkgcmV0dXJuICdub25lJztcbiAgICByZXR1cm4gdGhpcy5heUpldHBhY2sgPiAwID8gJ3RvcCcgOiAnYm90dG9tJztcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==